# JavaScriptã®å•é¡Œé›†(99 Haskell Problemsã®ç¿»è¨³)ã¨è§£ç­”ä¾‹ãƒ»è§£èª¬

[H-99: Ninety-Nine Haskell Problems](https://wiki.haskell.org/H-99:_Ninety-Nine_Haskell_Problems)ã¨ã„ã†Haskellã®å•é¡Œé›†ãŒã‚ã‚Šã¾ã™ã€‚å…ƒã¯Prologã®å•é¡Œé›†ã ã£ãŸãã†ã§ã™ã€‚  
äºŒç•ªç…ã˜ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€ä»Šå›ã¯ã“ã®å•é¡Œé›†ã‚’å°‘ã—æ”¹å¤‰ã—ã¦ã€JavaScriptã§è§£ã„ã¦ã„ãã“ã¨ã«ã—ã¾ã™ã€‚  
ä¸€å¿œã€åŸºæœ¬çš„ãªæ§‹æ–‡ã®å­¦ç¿’ã‚’ä¸€é€šã‚Šçµ‚ãˆãŸåˆå¿ƒè€…ã«å‘ã‘ãŸè¨˜äº‹ã¨ã—ã¦æ›¸ã„ã¦ã„ã¾ã™ã€‚
  
å•é¡Œã¨è§£ç­”ä¾‹ã‚’åˆ†ã‘ã¦ãŠãã®ã§ã€å•é¡Œã‚’è§£ã„ã¦ã‹ã‚‰è§£ç­”ä¾‹ã‚’è¦‹ã‚‹ã‚ˆã†ã«ã™ã‚‹ã¨ã€ã‚ˆã‚Šç†è§£ãŒæ·±ã¾ã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚  
è§£ç­”ä¾‹ã«ã¯è§£èª¬ã‚‚ã¤ã‘ã¦ã„ãã¾ã™ã€‚

## ç’°å¢ƒæ§‹ç¯‰  

### Node.jsã¨Yarnã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

[Node.js](https://nodejs.org/ja/)ã‚’ä½¿ã„ã¾ã™ã®ã§ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ã€‚  
ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã«ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’é–‹ã„ã¦ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°PATHãŒé€šã£ã¦ã„ã¾ã™ã€‚  
åŸ·ç­†æ™‚ç‚¹ã§ã¯ã€Node.jsã¯`v11.0.0`ã€npmã¯`6.4.1`ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚

```sh
$ node -v
$ npm -v
```

[Yarn](https://yarnpkg.com/lang/ja/)ã‚‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚  
Yarnã¯npmã‚ˆã‚Šã‚‚é«˜é€Ÿãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ã§ã™ã€‚  

```sh
$ npm i -g yarn
```

### ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä½œæˆ

å•é¡Œã‚’è§£ã„ã¦ã„ããŸã‚ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½œæˆã—ã¾ã—ã‚‡ã†ã€‚  
ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```sh
$ mkdir js-99
$ cd js-99
$ yarn init -y
```

`js-99`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«`package.json`ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚

### Webpack

å•é¡Œã®è§£ç­”ã‚’ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦ãƒ“ãƒ«ãƒ‰ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã—ã‚‡ã†ã€‚  
ãŸãã•ã‚“è§£ã‘ã°ã€æœ€çµ‚çš„ã«ã¯[lodash](https://lodash.com/docs/)ã¿ãŸã„ãªæ„Ÿã˜ã«ãªã‚Šãã†ã§ã™ã­ï¼

Webpackã¯åˆ†å‰²ã—ãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä¸€ã¤ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¾ã¨ã‚ã¦ãã‚Œã‚‹ãƒãƒ³ãƒ‰ãƒ©ã§ã™ã€‚  
æœ€æ–°ã®JavaScriptã®æ§‹æ–‡ã‚’IE11ãªã©ã®å¤ã„ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚‚ä½¿ãˆã‚‹ã‚ˆã†ã«å¤‰æ›(ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«)ã—ã¦ãã‚Œã‚‹Babelã‚‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚  
ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã—ã‚‡ã†ã€‚ã“ã‚Œã‚‰ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯`node_modules`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒä½œæˆã•ã‚Œã¦ã€ãã“ã«æ ¼ç´ã•ã‚Œã¾ã™ã€‚

```sh
$ yarn add -D @babel/core @babel/preset-env @babel/register babel-loader webpack@4.x webpack-cli
```

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç›´ä¸‹ã«`.babelrc`ã‚’ä½œæˆã—ã€ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šã—ã¾ã™ã€‚

```json
{ 
  "presets": ["@babel/preset-env"]
}
```

`webpack.config.babel.js`ã‚’ä½œæˆã—ã€webpackã®è¨­å®šã‚’æ›¸ã„ã¦ã„ãã¾ã™ã€‚  
`output`ã¯ãƒãƒ³ãƒ‰ãƒ«ã—ãŸJSãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã®è¨­å®šã§ã™ã€‚

```js
import path from 'path'

export default {
  mode: 'production',
  entry: path.join(__dirname, 'src', 'index.js'),
  output: {
    library: 'js99',
    libraryTarget: 'umd',
    globalObject: 'this',
    filename: 'js-99.js',
    path: path.join(__dirname, 'dist')
  }
}
```

`package.json`ã«`scripts`ã‚’è¿½è¨˜ã—ã¾ã™ã€‚  
ã“ã‚Œã¯npm-scriptsã¨ã„ã†ã‚‚ã®ã§ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ›¸ã„ã¦ãŠãã¨`yarn <scriptå>`ã§å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```json
{
  ...
  "scripts": {
    "build": "webpack"
  },
  ...
}
```

`src`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã€`index.js`ã‚’ä»¥ä¸‹ã®ã‚ˆã†ãªå†…å®¹ã§ä½œæˆã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```js
export default { hoge: 'fuga' }
```

æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦`dist/js-99.js`ãŒå‡ºåŠ›ã•ã‚Œã‚Œã°æˆåŠŸã§ã™ã€‚  
REPLã§`require`ã—ã¦ç¢ºã‹ã‚ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

```sh
$ yarn build
```

```sh
$ node
> require('./dist/js-99')
{ default: { hoge: 'fuga' } }
```

### Jest

å•é¡ŒãŒè§£ã‘ãŸã‹ã©ã†ã‹ç¢ºã‹ã‚ã‚‹ãŸã‚ã«ã€ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆãŒã§ãã‚‹ç’°å¢ƒã‚’ä½œã‚Šã¾ã—ã‚‡ã†ã€‚  
ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã‚’ã™ã‚‹ãŸã‚ã«Jestã‚’å°å…¥ã—ã¾ã™ã€‚

```sh
$ yarn add -D jest babel-jest babel-core@^7.0.0-bridge.0 regenerator-runtime
```

`package.json`ã®`scripts`ã«`test`ã‚’è¿½è¨˜ã—ã¾ã™ã€‚

```json
{
  ...
  "scripts": {
    "build": "webpack",
    "test": "jest"
  },
  ...
}
```

å‹•ä½œç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚  
`test`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã€`index.test.js`ã«ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã‚’æ›¸ã„ã¦ã„ãã¾ã™ã€‚

```js
import hoge from '../src'

test('å‹•ä½œç¢ºèª', () => {
  expect(hoge.hoge).toBe('fuga')
})
```

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚

```sh
$ yarn test
```

æ¬¡ã®ã‚ˆã†ãªå‡ºåŠ›ã«ãªã‚Œã°æˆåŠŸã§ã™ã€‚

```
[PASS] test/index.test.js
  âˆš å‹•ä½œç¢ºèª (3ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.425s
Ran all test suites.
Done in 2.16s.
```


### è©¦ã—ã«1å•è§£ã„ã¦ã¿ã‚‹

H-99ã®22å•ç›®ã®ã€ŒæŒ‡å®šã•ã‚ŒãŸç¯„å›²å†…ã®ã™ã¹ã¦ã®æ•´æ•°ã‚’å«ã‚€é…åˆ—ã‚’ç”Ÿæˆã™ã‚‹é–¢æ•°`range`ã‚’å®Ÿè£…ã™ã‚‹ã€ã¨ã„ã†å•é¡Œã‚’è©¦ã—ã«è§£ã„ã¦ã¿ã¾ã™ã€‚  
Haskellã«ã¯`[4..9]`ã®ã‚ˆã†ã«æ›¸ãã¨`[4,5,6,7,8,9]`ãŒç”Ÿæˆã•ã‚Œã‚‹æ§‹æ–‡ãŒã‚ã‚‹ãŸã‚ã€ãã‚Œã¨åŒæ§˜ã®çµæœã‚’è¿”ã™`range`ã¯é¢ç™½ãã†ã ã¨æ€ã£ãŸã‹ã‚‰ã§ã™ã€‚  
åˆå›ãªã®ã§ã€ã¨ã‚Šã‚ãˆãšãã‚Œãªã‚Šã«ãƒ†ã‚¹ãƒˆã‚‚æ›¸ã„ã¦ã¿ã¾ã™ã€‚

`range`é–¢æ•°ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªå‹•ä½œã«ãªã‚‹ã¯ãšã§ã™ã€‚

```js
range(4, 9) // [4,5,6,7,8,9]
```

ã¾ãšã¯ãƒ†ã‚¹ãƒˆã‹ã‚‰æ›¸ã„ã¦ã¿ã¾ã™ã€‚`range(5, 1)`ã®ã‚ˆã†ãªå¼•æ•°ã‚’æ¸¡ã™ã¨ç©ºã®é…åˆ—ãŒè¿”ã£ã¦ãã‚‹ã“ã¨ã‚’æƒ³å®šã—ã¾ã™ã€‚  
`test/index.test.js`ã‚’æ¬¡ã®ã‚ˆã†ã«ç·¨é›†ã—ã¾ã™ã€‚

```js
import { range } from '../src'

describe('å•22: æŒ‡å®šã•ã‚ŒãŸç¯„å›²å†…ã®ã™ã¹ã¦ã®æ•´æ•°ã‚’å«ã‚€é…åˆ—ã‚’ç”Ÿæˆã™ã‚‹', () => {
  test('4ã‹ã‚‰9ã¾ã§ã®æ•´æ•°ã®é…åˆ—', () => {
    expect(range(4, 9)).toEqual([4, 5, 6, 7, 8, 9])
  })

  test('5ã‹ã‚‰1ã¾ã§ã®æ•´æ•°ã®é…åˆ—ï¼ˆç©ºã®é…åˆ—ï¼‰', () => {
    expect(range(5, 1)).toEqual([])
  })
})
```

ã¾ã æœªå®Ÿè£…ãªã®ã§`yarn test`ã‚’ã™ã‚‹ã¨å¤±æ•—ã—ã¾ã™ã€‚  
ã“ã®ãƒ†ã‚¹ãƒˆã‚’ãƒ‘ã‚¹ã§ãã‚‹ã‚ˆã†ã«`src/index.js`ã«å®Ÿè£…ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚  

```js
/**
 * æŒ‡å®šã•ã‚ŒãŸç¯„å›²å†…ã®ã™ã¹ã¦ã®æ•´æ•°ã‚’å«ã‚€é…åˆ—ã‚’ç”Ÿæˆã™ã‚‹
 * @param {number} start é–‹å§‹
 * @param {number} end çµ‚äº†
 * @returns {number[]} ç¯„å›²å†…ã®ã™ã¹ã¦ã®æ•´æ•°ã‚’å«ã‚€é…åˆ—
 */
export const range = (start, end) => {
  const list = []
  
  for (let i = start; i <= end; i++) {
    list.push(i)
  }

  return list
}
```

ã“ã‚Œã§`yarn test`ã‚’ãƒ‘ã‚¹ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼æ›¸ã„ãŸãƒ†ã‚¹ãƒˆãŒå…¨ã¦ç·‘è‰²ã«ãªã‚‹ã®ã¯æ°—æŒã¡ã„ã„ã§ã™ã­ã€‚  
ã¤ã„ã§ã«ã€ã€ŒæŒ‡å®šã•ã‚ŒãŸç¯„å›²å†…ã®ã™ã¹ã¦ã®æ–‡å­—ã‚’å«ã‚€é…åˆ—ã€ã‚‚`range`é–¢æ•°ã§è¿”ã™ã‚ˆã†ã«ã—ã¦ã¿ã¾ã™ã€‚  
Haskellã§ã¯`['a'..'z']`ã§å°æ–‡å­—ã®ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆã®é…åˆ—ã‚’è¡¨ç¾ã§ãã‚‹ã‹ã‚‰ã§ã™ã€‚

é–¢æ•°ã«å¤‰æ›´ã‚’åŠ ãˆã¦ã‚‚å…ˆã»ã©æ›¸ã„ãŸãƒ†ã‚¹ãƒˆã¯å½“ç„¶é€šã‚‹ã‚ˆã†ã«ã—ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚  
é€†ã«ã€å¤‰æ›´ã«ã‚ˆã£ã¦ãƒã‚°ãŒç”Ÿã˜ãŸå ´åˆã¯ã€ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã‚’ãƒ‘ã‚¹ã—ãªããªã£ã¦ã™ãã«åˆ†ã‹ã‚‹ã‚ã‘ã§ã™ã€‚

`test/index.test.js`ã«ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ ã—ã¾ã—ã‚‡ã†ã€‚

```js
describe('å•22: æŒ‡å®šã•ã‚ŒãŸç¯„å›²å†…ã®ã™ã¹ã¦ã®æ•´æ•°ã¾ãŸã¯æ–‡å­—ã‚’å«ã‚€é…åˆ—ã‚’ç”Ÿæˆã™ã‚‹', () => {
  /* çœç•¥ */

  test('aã‹ã‚‰zã¾ã§ã®æ–‡å­—ã®é…åˆ—', () => {
    expect(range('a', 'z')).toEqual(['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z'])
  })

  test('å¼•æ•°ã®å‹ãŒç•°ãªã‚‹ï¼ˆã‚¨ãƒ©ãƒ¼ï¼‰', () => {
    expect(() => range(1, 'a')).toThrowError()
  })

  test('å¼•æ•°ãŒæ–‡å­—åˆ—ã®ã¨ãã€é•·ã•ãŒ2ä»¥ä¸Šã‚ã‚‹ï¼ˆã‚¨ãƒ©ãƒ¼ï¼‰', () => {
    expect(() => range('aa', 'b')).toThrowError()
  })
})
```

`src/index.js`ã®`range`é–¢æ•°ã«æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¾ã—ã‚‡ã†ã€‚

```js
/**
 * æŒ‡å®šã•ã‚ŒãŸç¯„å›²å†…ã®ã™ã¹ã¦ã®æ•´æ•°ã¾ãŸã¯æ–‡å­—ã‚’å«ã‚€é…åˆ—ã‚’ç”Ÿæˆã™ã‚‹
 * @param {number|string} start é–‹å§‹ä½ç½®ã®è¦ç´ 
 * @param {number|string} end çµ‚äº†ä½ç½®ã®è¦ç´ 
 * @returns {number[]|string[]} ç¯„å›²å†…ã®ã™ã¹ã¦ã®è¦ç´ ã‚’å«ã‚€é…åˆ—
 */
export const range = (start, end) => {
  if (typeof(start) !== typeof(end)) {
    throw new Error('å¼•æ•°ã¯åŒã˜å‹ã«ã—ã¦ãã ã•ã„')
  }

  const isStr = typeof(start) === 'string'

  if (isStr && (start.length !== 1 || end.length !== 1)) {
    throw new Error('å¼•æ•°ã«ã™ã‚‹æ–‡å­—åˆ—ã®é•·ã•ã¯1ã«ã—ã¦ãã ã•ã„')
  }

  const list = []
  
  if (isStr) {
    start = start.charCodeAt(0)
    end = end.charCodeAt(0)
  }  

  for (let i = start; i <= end; i++) {
    list.push(isStr ? String.fromCharCode(i) : i)
  }

  return list
}
```

å°‘ã—é•·ããªã£ã¦ã—ã¾ã„ã¾ã—ãŸã€‚`yarn test`ã§å…¨ã¦ãƒ‘ã‚¹ã•ã‚Œã¦ã„ã‚Œã°æˆåŠŸã§ã™ã€‚


## å•é¡Œ(99 JavaScript Problems)

å•é¡Œã‚’JavaScriptç”¨ã«æ”¹å¤‰ã—ã¦ã„ã‚‹ã¨ã“ã‚ãŒã‚ã‚Šã¾ã™ã€‚  
ã“ã‚Œã«ã‚ˆã£ã¦é›£æ˜“åº¦ã«ãƒãƒ©ã¤ããŒå‡ºã¦ã„ã¾ã™ãŒã€ã”äº†æ‰¿ãã ã•ã„ã€‚  

ä¸€éƒ¨ã®å•é¡Œã¯çµ±åˆã—ã¦ã„ã‚‹ãŸã‚ã€æœ¬å½“ã«99å•ã‚ã‚‹ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

### å•1ï½10: é…åˆ—

#### å•1: é…åˆ—ã‚„æ–‡å­—åˆ—ã®æœ€å¾Œã®è¦ç´ ã‚’å–ã‚Šå‡ºã™`last`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
last([1, 2, 3, 4]) // 4
last('xyz') // z
```

#### å•2: é…åˆ—ã‚„æ–‡å­—åˆ—ã®æœ€å¾Œã®ä¸€ã¤å‰ã®è¦ç´ ã‚’å–ã‚Šå‡ºã™`butLast`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
butLast([1, 2, 3, 4]) // 3
butLast('abcdefghijklmnopqrstuvwxyz') // y
```

#### å•3: é…åˆ—ã‚„æ–‡å­—åˆ—ã®nç•ªç›®ã®è¦ç´ ã‚’å–ã‚Šå‡ºã™`elementAt`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

ãŸã ã—ã€æœ€åˆã®è¦ç´ ã¯0ç•ªç›®ã§ã¯ãªãã€1ç•ªç›®ã¨æ•°ãˆã¾ã™ã€‚

```js
elementAt([1, 2, 3], 2) // 2
elementAt('JavaScript', 5) // S
```

#### å•4: é…åˆ—ã‚„æ–‡å­—åˆ—ã®é•·ã•ã‚’è¿”ã™`length`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

`Array.length`ã‚„`String.length`ã¯ä½¿ç”¨ã—ãªã„ã“ã¨ã€‚  
ã¾ãŸã€çµµæ–‡å­—ã®é•·ã•ã¯`1`ã¨æ•°ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã€‚

```js
length([123, 456, 789]) // 3
length('ğŸ’ƒHello, World!ğŸ’ƒ') // 15
```

#### å•5: é…åˆ—ã‚„æ–‡å­—åˆ—ã‚’é€†é †ã«ã—ã¦è¿”ã™`reverse`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

`Array.reverse`ã¯ä½¿ç”¨ã—ãªã„ã“ã¨ã€‚  
ã¾ãŸã€çµµæ–‡å­—ã®é•·ã•ã¯`1`ã¨æ•°ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã€‚

```js
reverse('A man, a plan, a canal, panama!ğŸ’ƒ') // ğŸ’ƒ!amanap ,lanac a ,nalp a ,nam A
reverse([1, 2, 3, 4]) // [4, 3, 2, 1]
```

#### å•6: é…åˆ—ã‚„æ–‡å­—åˆ—ãŒå›æ–‡ã‹ã©ã†ã‹ã‚’è¿”ã™`isPalindrome`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
isPalindrome([1, 2, 3]) // false
isPalindrome('ãŸã‘ã‚„ã¶ã‚„ã‘ãŸ') // true
isPalindrome([1, 2, 4, 8, 16, 8, 4, 2, 1]) // true
```

#### å•7: ãƒã‚¹ãƒˆã—ã¦ã„ã‚‹é…åˆ—ã‚’å¹³å¦ï¼ˆä¸€æ¬¡å…ƒé…åˆ—ï¼‰ã«ã—ã¦è¿”ã™`flatten`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

`Array.flat`ã¯ä½¿ç”¨ã—ãªã„ã“ã¨ã€‚

```js
flatten([1, [2, [3, 4], 5]]) // [1, 2, 3, 4, 5]
```

#### å•8: é…åˆ—ã‚„æ–‡å­—åˆ—ã‹ã‚‰åŒã˜è¦ç´ ã®ç¹°ã‚Šè¿”ã—ã‚’æ’é™¤ã—ã¦è¿”ã™`compress`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
compress([1, 1, 2, 1, 2, 2, 3, 3, 3, 3]) // [ 1, 2, 1, 2, 3 ]
compress('aaaabccaadeeee') // abcade
```

#### å•9: é…åˆ—ã‚„æ–‡å­—åˆ—ã®åŒã˜è¦ç´ ã®ç¹°ã‚Šè¿”ã—ã‚’é…åˆ—ã¨ã—ã¦ã¾ã¨ã‚ã¦è¿”ã™`pack`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
pack([1, 1, 2, 1, 2, 2, 3, 3, 3, 3]) // [[1, 1], [2], [1], [2, 2], [3, 3, 3, 3]]
pack('aaaabccaadeeee') // ['aaaa', 'b', 'cc', 'aa', 'd', 'eeee']
```

#### å•10: `pack`é–¢æ•°ã‚’ç”¨ã„ã¦ã€é…åˆ—ã‚„æ–‡å­—åˆ—ã‚’ãƒ©ãƒ³ãƒ¬ãƒ³ã‚°ã‚¹åœ§ç¸®ã™ã‚‹`encode`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
encode([1, 1, 2, 1, 2, 2, 3, 3, 3, 3]) // [[2, 1], [1, 2], [1, 1], [2, 2], [4, 3]]
encode('aaaabccaadeeee')
// [[4, 'a'], [1, 'b'], [2, 'c'], [2, 'a'], [1, 'd'], [4, 'e']]
```

### å•11ï½20: é…åˆ—ã®ç¶šã

#### å•11: å•10ã®çµæœã‚’å¤‰æ›´ã—ã€é‡è¤‡ãŒç„¡ã‘ã‚Œã°ãƒ©ãƒ³ãƒ¬ãƒ³ã‚°ã‚¹åœ§ç¸®ã›ãšã«è¦ç´ ã‚’æ ¼ç´ã™ã‚‹`encodeModified`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
encodeModified([1, 1, 2, 1, 2, 2, 3, 3, 3, 3]) // [[2, 1], 2, 1, [2, 2], [4, 3]]
encodeModified('aaaabccaadeeee')
// [[4, 'a'], 'b', [2, 'c'], [2, 'a'], 'd', [4, 'e']]
```

#### å•12: ãƒ©ãƒ³ãƒ¬ãƒ³ã‚°ã‚¹åœ§ç¸®ã—ãŸé…åˆ—ã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹`decodeModified`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
decodeModified([[2, 1], 2, 1, [2, 2], [4, 3]]) // [1, 1, 2, 1, 2, 2, 3, 3, 3, 3]
decodeModified([[4, 'a'], 'b', [2, 'c'], [2, 'a'], 'd', [4, 'e']]) // aaaabccaadeeee
```

#### å•13: `pack`é–¢æ•°ã®ã‚ˆã†ã«é‡è¤‡ã‚’å«ã‚€é…åˆ—ã‚’ä½œã‚‰ãšã«ã€ç›´æ¥ãƒ©ãƒ³ãƒ¬ãƒ³ã‚°ã‚¹åœ§ç¸®ã™ã‚‹`encodeDirect`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
encodeDirect([1, 1, 2, 1, 2, 2, 3, 3, 3, 3]) // [[2, 1], 2, 1, [2, 2], [4, 3]]
encodeDirect('aaaabccaadeeee')
// [[4, 'a'], 'b', [2, 'c'], [2, 'a'], 'd', [4, 'e']]
```

#### å•14: é…åˆ—ã‚„æ–‡å­—åˆ—ã®è¦ç´ ã‚’è¤‡è£½ã™ã‚‹`dupli`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
dupli([1, 2, 3]) // [1, 1, 2, 2, 3, 3]
dupli('abc') // aabbcc
```

#### å•15: æŒ‡å®šã•ã‚ŒãŸå›æ•°ã ã‘é…åˆ—ã‚„æ–‡å­—åˆ—ã®è¦ç´ ã‚’è¤‡è£½ã™ã‚‹`repli`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
repli([1, 2, 3], 3) // [1, 1, 1, 2, 2, 2, 3, 3, 3]
repli('abc', 3) // aaabbbccc
```

#### å•16: nã®å€æ•°ã®ä½ç½®ã®è¦ç´ ã‚’é…åˆ—ã‚„æ–‡å­—åˆ—ã‹ã‚‰å‰Šé™¤ã™ã‚‹`drop`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
drop([1, 2, 3, 4], 2) // [1, 3] 
drop('abcdefghik', 3) // 'abdeghk'
```

#### å•17: é…åˆ—ã‚„æ–‡å­—åˆ—ã‚’æŒ‡å®šã—ãŸä½ç½®ã§åˆ†ã‘ã‚‹`split`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
split([1, 2, 3, 4], 2) // [[1, 2], [3, 4]]
split('abcdefghik', 3) // ['abc', 'defghik']
```

#### å•18: é¸æŠã—ãŸç¯„å›²ã‚’é…åˆ—ã‚„æ–‡å­—åˆ—ã‹ã‚‰å–ã‚Šå‡ºã™`slice`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

`Array.slice`ã¯ä½¿ç”¨ã—ãªã„ã“ã¨ã€‚

```js
slice([1, 2, 3, 4], 2, 4) // [2, 3, 4]
slice('abcdefghik', 3, 7) // cdefg
```

#### å•19: é…åˆ—ã‚„æ–‡å­—åˆ—ã®è¦ç´ ã‚’å·¦ã«nå€‹ãšã‚‰ã™`rotate`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

è² ã®æ•°ã‚’æ¸¡ã—ãŸã‚‰å³ã«ãšã‚‰ã™ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚

```js
rotate([1, 2, 3], 1) // [2, 3, 1]
rotate('abcdefgh', 3) // defghabc
rotate('abcdefgh', -2) // ghabcdef
```

#### å•20: é…åˆ—ã‚„æ–‡å­—åˆ—ã®nç•ªç›®ã®è¦ç´ ã‚’å‰Šé™¤ã™ã‚‹`removeAt`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

å‰Šé™¤ã—ãŸè¦ç´ ã¨å‡¦ç†å¾Œã®é…åˆ—ã‚’ã€é…åˆ—ã«æ ¼ç´ã—ã¦è¿”ã—ã¦ãã ã•ã„ã€‚

```js
removeAt(3, [1, 2, 3]) // [3, [1, 2]]
removeAt(2, 'abcd') // ['b', 'acd']
```

### å•21ï½28: é…åˆ—ã€å†ã³

#### å•21: é…åˆ—ã‚„æ–‡å­—åˆ—ã®æŒ‡å®šã—ãŸä½ç½®ã«è¦ç´ ã‚’æŒ¿å…¥ã™ã‚‹`insertAt`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
insertAt(5, [1, 2, 3, 4], 3) // [1, 2, 5, 3, 4]
insertAt('X', 'abcd', 2) // aXbcd
```

#### å•22: æŒ‡å®šã•ã‚ŒãŸç¯„å›²å†…ã®ã™ã¹ã¦ã®æ•´æ•°ã¾ãŸã¯æ–‡å­—ã‚’å«ã‚€é…åˆ—ã‚’ç”Ÿæˆã™ã‚‹`range`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
range(4, 9) // [4, 5 ,6, 7, 8, 9]
range('a', 'z') // ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z']
```

#### å•23: é…åˆ—ã‚„æ–‡å­—åˆ—ã‹ã‚‰æŒ‡å®šã•ã‚ŒãŸæ•°ã¶ã‚“ã ã‘ãƒ©ãƒ³ãƒ€ãƒ ã«è¦ç´ ã‚’å–ã‚Šå‡ºã™`rndSelect`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
rndSelect('abcdefgh', 3) // eda ãªã©
```

#### å•24: é•·ã•nã®1ä»¥ä¸Šmä»¥ä¸‹ã®ä¹±æ•°åˆ—ã‚’ç”Ÿæˆã™ã‚‹`diffSelect`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
diffSelect(6, 49) // [23, 1, 17, 33, 21, 37] ãªã©
```

#### å•25: é…åˆ—ã‚„æ–‡å­—åˆ—ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«ä¸¦ã³æ›¿ãˆã‚‹`rndPermu`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
rndPermu('abcdef') // badcef ãªã©
```

#### å•26: må€‹ã®è¦ç´ ã‹ã‚‰nå€‹ã‚’é¸ã‚“ã çµ„ã¿åˆã‚ã›ã‚’è¿”ã™`combinations`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
combinations('abcdef', 2) // ['ab', 'ac', 'ad', 'ae', 'af', 'bc', 'bd', 'be', 'bf', 'cd', 'ce', 'cf', 'de', 'df', 'ef']
```

#### å•27: é…åˆ—ã®è¦ç´ ã‚’äº’ã„ã«ç´ ãªé…åˆ—ã«ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã—ã¦è¿”ã™`group`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
group(["aldo","beat","carla","david","evi","flip","gary","hugo","ida"], 2, 3, 4)
// [[["aldo","beat"],["carla","david","evi"],["flip","gary","hugo","ida"]],...] 1260å€‹ã®è§£
group(["aldo","beat","carla","david","evi","flip","gary","hugo","ida"], 2, 2, 5)
// [[["aldo","beat"],["carla","david"],["evi","flip","gary","hugo","ida"]],...] 756å€‹ã®è§£
```

#### å•28: é…åˆ—ã®é…åˆ—ã‚’ã€è¦ç´ ã®é•·ã•ã§ã‚½ãƒ¼ãƒˆã™ã‚‹`lsort`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚ã¾ãŸã€è¦ç´ ã®é•·ã•ã®é »åº¦é †ã«ã‚½ãƒ¼ãƒˆã™ã‚‹`lfsort`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
lsort(["abc","de","fgh","de","ijkl","mn","o"]) // ["o","de","de","mn","abc","fgh","ijkl"]
```

```js
lfsort(["abc", "de", "fgh", "de", "ijkl", "mn", "o"]) // ["ijkl","o","abc","fgh","de","de","mn"]
```

### å•31ï½41: ç®—è¡“

#### å•31: å¼•æ•°ãŒç´ æ•°ã‹ã©ã†ã‹ã‚’è¿”ã™`isPrime`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
isPrime(7) // true
```

#### å•32: [ãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰ã®äº’é™¤æ³•](https://ja.wikipedia.org/wiki/%E3%83%A6%E3%83%BC%E3%82%AF%E3%83%AA%E3%83%83%E3%83%89%E3%81%AE%E4%BA%92%E9%99%A4%E6%B3%95)ã‚’ä½¿ã£ã¦æœ€å¤§å…¬ç´„æ•°ã‚’æ±‚ã‚ã‚‹`gcd`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
gcd(36, 63) // 9
```

#### å•33: æ¸¡ã—ãŸ2ã¤ã®æ•´æ•°ãŒäº’ã„ã«ç´ ã‹ã©ã†ã‹ã‚’è¿”ã™`coprime`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
coprime(35, 64) // true
```

#### å•34: [ã‚ªã‚¤ãƒ©ãƒ¼ã®Ï†é–¢æ•°](https://ja.wikipedia.org/wiki/%E3%82%AA%E3%82%A4%E3%83%A9%E3%83%BC%E3%81%AE%CF%86%E9%96%A2%E6%95%B0)`totient`ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
totient(10) // 4
```

#### å•35: å¼•æ•°ã‚’ç´ å› æ•°åˆ†è§£ã™ã‚‹`primeFactors`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

çµæœã¯æ˜‡é †ã«ã‚½ãƒ¼ãƒˆã™ã‚‹ã“ã¨ã€‚

```js
primeFactors(315) // [3, 3, 5, 7]
```

#### å•36: å•35ã®çµæœã‚’ç´¯ä¹—ã§è¡¨ç¾ã™ã‚‹`primeFactorsMult`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

`3 ** 2`ãªã‚‰`[3, 2]`ã¨è¡¨ç¾ã—ã¾ã™ã€‚

```js
primeFactorsMult(315) // [[3, 2], [5, 1], [7, 1]]
```

#### å•37: ã‚ªã‚¤ãƒ©ãƒ¼ã®Ï†é–¢æ•°ã‚’æ”¹è‰¯ã—ãŸ`phi`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

å•36ã®çµæœã‚’`[[p1, m1], [p2, m2], [p3, m3], ...]`ã¨ã—ãŸã¨ãã€ã‚ªã‚¤ãƒ©ãƒ¼ã®Ï†é–¢æ•°ã¯æ¬¡ã®ã‚ˆã†ã«ã—ã¦è¨ˆç®—ã§ãã¾ã™ã€‚

```
phi(m) = (p1 - 1) * p1 ** (m1 - 1) * 
         (p2 - 1) * p2 ** (m2 - 1) * 
         (p3 - 1) * p3 ** (m3 - 1) * ...
```

```js
phi(10) // 4
```

#### å•38: å•34ã¨å•37ã®å®Ÿè¡Œæ™‚é–“ã‚’æ¯”è¼ƒã›ã‚ˆã€‚

`totient(10090)`ã¨`phi(10090)`ã‚’å®Ÿè¡Œã—ã¦ã€`phi`é–¢æ•°ã®ã»ã†ãŒåŠ¹ç‡çš„ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºã‹ã‚ã¦ãã ã•ã„ã€‚  
ã›ã£ã‹ããªã®ã§ã€é–¢æ•°ã®å®Ÿè¡Œæ™‚é–“ã‚’è¨ˆæ¸¬ã™ã‚‹`time`é–¢æ•°ã‚’å®Ÿè£…ã—ã¦èª¿ã¹ã¾ã—ã‚‡ã†ã€‚

```js
time(totient, 10090) < time(phi, 10090) // true
```

#### å•39: ä¸ãˆã‚‰ã‚ŒãŸç¯„å›²å†…ã®ç´ æ•°ã®é…åˆ—ã‚’è¿”ã™`primesR`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
primesR(10, 20) // [11, 13, 17, 19]
```

#### å•40: ã‚´ãƒ¼ãƒ«ãƒ‰ãƒãƒƒãƒã®äºˆæƒ³ã‚’ç¢ºã‹ã‚ã‚‹`goldbach`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

ã‚´ãƒ¼ãƒ«ãƒ‰ãƒãƒƒãƒã®äºˆæƒ³ã¯ã€Œå…¨ã¦ã®2ã‚ˆã‚Šã‚‚å¤§ããªå¶æ•°ã¯2ã¤ã®ç´ æ•°ã®å’Œã¨ã—ã¦è¡¨ã™ã“ã¨ãŒã§ãã‚‹ã€ã¨ã„ã†äºˆæƒ³ã§ã™ã€‚

```js
goldbach(28) // [5, 23]
```

#### å•41: ä¸ãˆã‚‰ã‚ŒãŸç¯„å›²å†…ã®`goldbach`ã®çµæœã‚’å‡ºåŠ›ã™ã‚‹`goldbachList`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

ç¬¬ä¸‰å¼•æ•°ã‚’ä¸ãˆãŸå ´åˆã€2ã¤ã®ç´ æ•°ãŒãã®å€¤ã‚ˆã‚Šå¤§ãã„ã‚‚ã®ã®ã¿ã‚’å‡ºåŠ›ã™ã‚‹ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚

```js
goldbachList(9, 20) // [[3, 7], [5, 7], [3, 11], [3, 13], [5, 13], [3,17]]
goldbachList(4, 2000, 50) // [[73, 919], [61, 1321], [67, 1789], [61, 1867]]
```

### å•46ï½50: è«–ç†ã¨ç¬¦å·

#### å•46: çœŸç†å€¤è¡¨ã‚’ä½œæˆã™ã‚‹`table`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

`table((a, b, c) => a && (b || c))`ã®ã‚ˆã†ã«ã€å¼•æ•°ãŒå¢—ãˆã¦ã‚‚çœŸç†å€¤è¡¨ã‚’å‡ºåŠ›ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚

```js
table((a, b) => a && (a || b))
/*
[
  [[true, true], true],
  [[true, false], true],
  [[false, true], false],
  [[false, false], false]
]
*/
```

#### å•49: ä¸ãˆã‚‰ã‚ŒãŸbitæ•°ã®[ã‚°ãƒ¬ã‚¤ã‚³ãƒ¼ãƒ‰](https://ja.wikipedia.org/wiki/%E3%82%B0%E3%83%AC%E3%82%A4%E3%82%B3%E3%83%BC%E3%83%89)ã®é…åˆ—ã‚’æ±‚ã‚ã‚‹`gray`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
gray(3) // ["000","001","011","010","110","111","101","100"]
```

#### å•50: [ãƒãƒ•ãƒãƒ³ç¬¦å·åŒ–](https://ja.wikipedia.org/wiki/%E3%83%8F%E3%83%95%E3%83%9E%E3%83%B3%E7%AC%A6%E5%8F%B7)ã‚’ã™ã‚‹`huffman`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

ç¬¦å·åŒ–ã™ã‚‹è¦ç´ ã¯`[è¨˜å·, å‡ºç¾é »åº¦]`ã§è¡¨ã•ã‚Œã¾ã™ã€‚ã¤ã„ã§ã«ã€æ–‡å­—åˆ—ã‚‚å¤‰æ›ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã—ã‚‡ã†ã€‚

```js
huffman([['a', 45], ['b', 13], ['c', 12], ['d', 16], ['e', 9], ['f', 5]])
// [['a', '0'], ['b', '101'], ['c', '100'], ['d', '111'], ['e', '1101'], ['f', '1100']]
huffman('DAEBCBACBBBC') // [['A', '111'], ['B', '0'], ['C', '10'], ['D', '1100'], ['E', '1101'] ]
```

### å•54ï½60: äºŒåˆ†æœ¨

#### å•54: äºŒåˆ†æœ¨ã‚¯ãƒ©ã‚¹`BinaryTree`ã‚’å®Ÿè£…ã›ã‚ˆã€‚

äºŒåˆ†æœ¨ã¯ã€ã‚ã‚‹ãƒãƒ¼ãƒ‰ãŒæŒã¤å­ã®æ•°ãŒ2å€‹ä»¥ä¸‹ã®æœ¨æ§‹é€ ã§ã™ã€‚  

ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«äºŒåˆ†æœ¨ã«ã—ãŸã„é…åˆ—ã‚’æ¸¡ã™ã¨ã€äºŒåˆ†æœ¨ã¨ã—ã¦è¡¨ç¾ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚  
å¼•æ•°ã¨ã™ã‚‹é…åˆ—ã¯ã€`[å€¤, å·¦éƒ¨åˆ†æœ¨, å³éƒ¨åˆ†æœ¨]`ã§è¡¨ç¾ã™ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚

```js
const tree = new BinaryTree(['a', ['b', 'd', 'e'], ['c', null, ['f', 'g', null]]])
console.log(tree.toString())
/*
{
  "value": "a",
  "left": {
    "value": "b",
    "left": {
      "value": "d",
      "left": null,
      "right": null
    },
    "right": {
      "value": "e",
      "left": null,
      "right": null
    }
  },
  "right": {
    "value": "c",
    "left": null,
    "right": {
      "value": "f",
      "left": {
        "value": "g",
        "left": null,
        "right": null
      },
      "right": null
    }
  }
}
*/
```

#### å•55: å·¦éƒ¨åˆ†æœ¨ã¨å³éƒ¨åˆ†æœ¨ã®ãƒãƒ¼ãƒ‰ã®æ•°ã®å·®ãŒ1ä»¥ä¸‹ã§ã‚ã‚‹äºŒåˆ†æœ¨ã‚’å…¨ã¦ç”Ÿæˆã™ã‚‹`cbalTree`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

ä¸‹è¨˜ã®çœç•¥ã•ã‚Œã¦ã„ã‚‹`[BinaryTree]`ã®éƒ¨åˆ†ã¯ã€`BinaryTree { value: 'x', left: null, right: null }`ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚

```js
BinaryTree.cbalTree(4)
/*
[ BinaryTree {
    value: 'x',
    left: BinaryTree { value: 'x', left: null, right: null },
    right: BinaryTree { value: 'x', left: null, right: [BinaryTree] } },
  BinaryTree {
    value: 'x',
    left: BinaryTree { value: 'x', left: null, right: [BinaryTree] },
    right: BinaryTree { value: 'x', left: null, right: null } },
  BinaryTree {
    value: 'x',
    left: BinaryTree { value: 'x', left: null, right: null },
    right: BinaryTree { value: 'x', left: [BinaryTree], right: null } },
  BinaryTree {
    value: 'x',
    left: BinaryTree { value: 'x', left: [BinaryTree], right: null },
    right: BinaryTree { value: 'x', left: null, right: null } } ]
*/
```

#### å•56: äºŒåˆ†æœ¨ãŒå¯¾ç§°ã‹ã©ã†ã‹ã‚’è¿”ã™`isSymmetric`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

ãƒãƒ¼ãƒ‰ã®å€¤ã¯æ¯”è¼ƒã—ã¾ã›ã‚“ã€‚ã‚ãã¾ã§ã€æ§‹é€ ãŒå¯¾ç§°ã‹ã©ã†ã‹ã‚’èª¿ã¹ã¾ã™ã€‚

```js
const x = new BinaryTree(['x', 'x', null])
const y = new BinaryTree(['x', 'x', 'x'])

x.isSymmetric // false
y.isSymmetric // true
```

#### å•57: äºŒåˆ†æ¢ç´¢æœ¨ã‚’ç”Ÿæˆã™ã‚‹`searchTree`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

å¼•æ•°ã¯ä¸€æ¬¡å…ƒé…åˆ—ã¨ã—ã¾ã™ã€‚

```js
BinaryTree.searchTree([3, 2, 5, 7, 1])
/*
BinaryTree {
  value: 3,
  left:
   BinaryTree {
     value: 2,
     left: BinaryTree { value: 1, left: null, right: null },
     right: null },
  right:
   BinaryTree {
     value: 5,
     left: null,
     right: BinaryTree { value: 7, left: null, right: null } } }
*/
BinaryTree.searchTree([5, 3, 18, 1, 4, 12, 21]).isSymmetric // true
BinaryTree.searchTree([3, 2, 5, 7, 4]).isSymmetric // false
```

#### å•58: å•55ã®ã‚ˆã†ã«å¹³è¡¡ã§ã€ã‹ã¤å¯¾ç§°ãªäºŒåˆ†æœ¨ãŒã‚ã‚Œã°è¿”ã™`symCbalTrees`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

å¼•æ•°ã¯ãƒãƒ¼ãƒ‰æ•°ã§ã€ãã®ã‚ˆã†ãªäºŒåˆ†æœ¨ãŒè¦‹ã¤ã‹ã‚‰ãªã‘ã‚Œã°`[]`ã‚’è¿”ã—ã¾ã™ã€‚  

```js
BinaryTree.symCbalTrees(5)
/*
[ BinaryTree {
    value: 'x',
    left: BinaryTree { value: 'x', left: null, right: [BinaryTree] },
    right: BinaryTree { value: 'x', left: [BinaryTree], right: null } },
  BinaryTree {
    value: 'x',
    left: BinaryTree { value: 'x', left: [BinaryTree], right: null },
    right: BinaryTree { value: 'x', left: null, right: [BinaryTree] } } ]
*/
```

#### å•59: å·¦éƒ¨åˆ†æœ¨ã¨å³éƒ¨åˆ†æœ¨ã®é«˜ã•ã®å·®ãŒ1ä»¥ä¸‹ã§ã‚ã‚‹äºŒåˆ†æœ¨ã‚’å…¨ã¦ç”Ÿæˆã™ã‚‹`hbalTree`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

å¼•æ•°ã¯ç”Ÿæˆã™ã‚‹æœ¨æ§‹é€ ã®é«˜ã•ï¼ˆæ ¹ãƒãƒ¼ãƒ‰ã®é«˜ã•ï¼‰ã¨ã—ã¾ã™ã€‚

```js
BinaryTree.hbalTree(3)[0]
/*
BinaryTree {
  value: 'x',
  left: BinaryTree { value: 'x', left: null, right: null },
  right:
   BinaryTree {
     value: 'x',
     left: null,
     right: BinaryTree { value: 'x', left: null, right: null } } }
*/
BinaryTree.hbalTree(4).length // 315
```

#### å•60: ä¸ãˆã‚‰ã‚ŒãŸæ•°ã®ãƒãƒ¼ãƒ‰ã‚’æŒã¤å•59ã®ã‚ˆã†ãªäºŒåˆ†æœ¨ã‚’å…¨ã¦ç”Ÿæˆã™ã‚‹`hbalTreeNodes`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

**ãƒ’ãƒ³ãƒˆ**  
ã¾ãšã€å·¦éƒ¨åˆ†æœ¨ã¨å³éƒ¨åˆ†æœ¨ã®é«˜ã•ã®å·®ãŒ1ä»¥ä¸‹ã§ã‚ã‚‹äºŒåˆ†æœ¨ã®é«˜ã•`h`ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«å¿…è¦ãªæœ€å°ãƒãƒ¼ãƒ‰æ•°ã‚’è¨ˆç®—ã™ã‚‹`minNodes`é–¢æ•°ã‚’å®šç¾©ã—ã¾ã™ã€‚  
å°‘ã—æ•°å¼ã‚’è€ƒãˆã¦ã¿ã‚Œã°ã€æœ€å°ãƒãƒ¼ãƒ‰æ•°ã¯ãƒ•ã‚£ãƒœãƒŠãƒƒãƒæ•°åˆ—ã«è¿‘ã„ã‚‚ã®ã«ãªã‚‹ã¯ãšã§ã™ã€‚  
æ¬¡ã«ã€`minNodes`é–¢æ•°ã‚’ç”¨ã„ã¦ã€å•é¡Œã®æœ¨æ§‹é€ ã®æœ€å¤§ã®é«˜ã•ã‚’æ±‚ã‚ã‚‹`maxHeight`é–¢æ•°ã‚’å®šç¾©ã—ã¾ã™ã€‚  
ãã®å¾Œã€æœ€å°ã‹ã‚‰æœ€å¤§ã¾ã§ã®é«˜ã•ã«ã¤ã„ã¦ã€ä¸ãˆã‚‰ã‚ŒãŸãƒãƒ¼ãƒ‰æ•°ã‚’æŒã¤äºŒåˆ†æœ¨ãŒã‚ã‚‹ã‹ã©ã†ã‹èª¿ã¹ã¾ã™ã€‚

```js
BinaryTree.hbalTreeNodes(15).length // 1553
[0, 1, 2, 3].map(BinaryTree.hbalTreeNodes)
/*
[ [ null ],
  [ BinaryTree { value: 'x', left: null, right: null } ],
  [ BinaryTree { value: 'x', left: null, right: [BinaryTree] },
    BinaryTree { value: 'x', left: [BinaryTree], right: null } ],
  [ BinaryTree { value: 'x', left: [BinaryTree], right: [BinaryTree] } ] ]
*/
```


### å•61ï½69: äºŒåˆ†æœ¨ã€ç¶šã

#### å•61: äºŒåˆ†æœ¨ã®è‘‰ã®æ•°ã‚’æ•°ãˆã‚‹`countLeaves`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
(new BinaryTree([1, [2, null, 4], 2])).countLeaves // 2
```

#### å•61A: äºŒåˆ†æœ¨ã®è‘‰ã®ãƒªã‚¹ãƒˆã‚’è¿”ã™`leaves`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
(new BinaryTree([1, [2, null, 4], 2])).leaves // [ 4, 2 ]
```

#### å•62: äºŒåˆ†æœ¨ã®å†…éƒ¨ãƒãƒ¼ãƒ‰ï¼ˆè‘‰ä»¥å¤–ã®ç¯€ï¼‰ã‚’è¿”ã™`internals`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
(new BinaryTree([1, [2, null, 4], 2])).internals // [ 1, 2 ]
```

#### å•62B: æŒ‡å®šã•ã‚ŒãŸæ·±ã•ã®ãƒãƒ¼ãƒ‰ã®ãƒªã‚¹ãƒˆã‚’è¿”ã™`atLevel`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
(new BinaryTree([1, [2, null, 4], 2])).atLevel(2) // [ 2, 2 ]
```

#### å•63: å®Œå…¨äºŒåˆ†æœ¨ã‚’ç”Ÿæˆã™ã‚‹`completeBinaryTree`é–¢æ•°ã¨ã€å®Œå…¨äºŒåˆ†æœ¨ã‹ã©ã†ã‹ã‚’è¿”ã™`isCompleteBinaryTree`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

å®Œå…¨äºŒåˆ†æœ¨ã¯ã€æ ¹ã‹ã‚‰ã™ã¹ã¦ã®è‘‰ã¾ã§ã®æ·±ã•ã®å·®ãŒ1ä»¥ä¸‹ã§ã€è‘‰ãŒå·¦è©°ã‚ã«ãªã£ã¦ã„ã‚‹äºŒåˆ†æœ¨ã§ã™ã€‚  
å¼•æ•°ã¯ãƒãƒ¼ãƒ‰æ•°ã¨ã—ã¾ã™ã€‚

```js
BinaryTree.completeBinaryTree(4)
/*
BinaryTree {
  value: 'x',
  left:
   BinaryTree {
     value: 'x',
     left: BinaryTree { value: 'x', left: null, right: null },
     right: null },
  right: BinaryTree { value: 'x', left: null, right: null } }
*/
(new BinaryTree(['x', ['x', 'x', null], ['x', null, null]])).isCompleteBinaryTree // true
(new BinaryTree(['x', ['x', 'x', null], ['x', null, 'x']])).isCompleteBinaryTree // false
```

#### å•64: æ¬¡ã®å›³ã®ã‚ˆã†ã«ã€å„ãƒãƒ¼ãƒ‰ã«åº§æ¨™ã‚’ä»˜ä¸ã™ã‚‹`layout`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

![å•64](./img/p64.gif)

æ¬¡ã®ã‚ˆã†ã«ãƒãƒ¼ãƒ‰ã«åº§æ¨™ã‚’å‰²ã‚ŠæŒ¯ã‚Šã¾ã™ã€‚

- xåº§æ¨™ã¯ã€ä¸­é †ã«èµ°æŸ»ã—ãŸã¨ãã®é †ç•ª
- yåº§æ¨™ã¯ã€ãã®ãƒãƒ¼ãƒ‰ãŒã‚ã‚‹æ·±ã•

çµæœãŒè¦‹ã¥ã‚‰ããªã‚‹ã®ã§ã€å„ãƒãƒ¼ãƒ‰ã®åº§æ¨™ã‚’åˆ†ã‹ã‚Šã‚„ã™ãå–å¾—ã§ãã‚‹`positions`é–¢æ•°ã‚‚ã¤ã„ã§ã«å®šç¾©ã—ã¾ã—ã‚‡ã†ã€‚

```js
const result = (new BinaryTree(['n', ['k', ['c', 'a', ['h', ['g', 'e', null], null]], 'm'], ['u', ['p', null, ['s', 'q', null]], null]])).layout()
result.positions
/*
[ { value: 'n', x: 8, y: 1 },
  { value: 'k', x: 6, y: 2 },
  { value: 'c', x: 2, y: 3 },
  { value: 'a', x: 1, y: 4 },
  { value: 'h', x: 5, y: 4 },
  { value: 'g', x: 4, y: 5 },
  { value: 'e', x: 3, y: 6 },
  { value: 'm', x: 7, y: 3 },
  { value: 'u', x: 12, y: 2 },
  { value: 'p', x: 9, y: 3 },
  { value: 's', x: 11, y: 4 },
  { value: 'q', x: 10, y: 5 } ]
*/
```

#### å•65: æ¬¡ã®å›³ã®ã‚ˆã†ã«ã€å„ãƒãƒ¼ãƒ‰ã«åº§æ¨™ã‚’ä»˜ä¸ã™ã‚‹`wideLayout`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

![å•65](./img/p65.gif)

é…ç½®ãƒ«ãƒ¼ãƒ«ã¯å›³ã‚’è¦‹ã¦è€ƒãˆã¦ãã ã•ã„ã€‚  

**ãƒ’ãƒ³ãƒˆ**  
ã‚ã‚‹æ·±ã•ã®éš£æ¥ã™ã‚‹ãƒãƒ¼ãƒ‰ã®æ°´å¹³è·é›¢ãŒä¸€å®šãªã“ã¨ã«ç€ç›®ã—ã¾ã—ã‚‡ã†ã€‚

```js
const result = (new BinaryTree(['n', ['k', ['c', 'a', ['e', 'd', 'g']], 'm'], ['u', ['p', null, 'q'], null]])).wideLayout()
result.positions
/*
[ { value: 'n', x: 15, y: 1 },
  { value: 'k', x: 7, y: 2 },
  { value: 'c', x: 3, y: 3 },
  { value: 'a', x: 1, y: 4 },
  { value: 'e', x: 5, y: 4 },
  { value: 'd', x: 4, y: 5 },
  { value: 'g', x: 6, y: 5 },
  { value: 'm', x: 11, y: 3 },
  { value: 'u', x: 23, y: 2 },
  { value: 'p', x: 19, y: 3 },
  { value: 'q', x: 21, y: 4 } ]
*/
```

#### å•66: æ¬¡ã®å›³ã®ã‚ˆã†ã«ã€å„ãƒãƒ¼ãƒ‰ã«åº§æ¨™ã‚’ä»˜ä¸ã™ã‚‹`compactLayout`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

![å•66](./img/p66.gif)

ã“ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’ç”¨ã„ã‚‹ã¨ã€å…¨ã¦ã®ãƒãƒ¼ãƒ‰ã«ãŠã„ã¦ä¸€å®šã®å¯¾ç§°æ€§ã‚’ä¿ã¡ã¤ã¤ã€ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆã«äºŒåˆ†æœ¨ã‚’è¡¨ç¾ã§ãã¾ã™ã€‚  
é…ç½®ãƒ«ãƒ¼ãƒ«ã¯å›³ã‚’è¦‹ã¦è€ƒãˆã¦ãã ã•ã„ã€‚  

**ãƒ’ãƒ³ãƒˆ**  
ãƒãƒ¼ãƒ‰ã¨å¾Œç¶™ãƒãƒ¼ãƒ‰é–“ã®æ°´å¹³è·é›¢ã«ç€ç›®ã—ã¾ã—ã‚‡ã†ã€‚

```js
const result = (new BinaryTree(['n', ['k', ['c', 'a', ['e', 'd', 'g']], 'm'], ['u', ['p', null, 'q'], null]])).compactLayout()
result.positions
/*
[ { value: 'n', x: 5, y: 1 },
  { value: 'k', x: 3, y: 2 },
  { value: 'c', x: 2, y: 3 },
  { value: 'a', x: 1, y: 4 },
  { value: 'e', x: 3, y: 4 },
  { value: 'd', x: 2, y: 5 },
  { value: 'g', x: 4, y: 5 },
  { value: 'm', x: 4, y: 3 },
  { value: 'u', x: 7, y: 2 },
  { value: 'p', x: 6, y: 3 },
  { value: 'q', x: 7, y: 4 } ]
*/
```

#### å•67: æ–‡å­—åˆ—ã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦äºŒåˆ†æœ¨ã«ã™ã‚‹`fromString`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

äºŒåˆ†æœ¨ã®æ–‡å­—åˆ—è¡¨ç¾ã¯`x(y,a(,b))`ã®ã‚ˆã†ã«ã—ã¦ä¸ãˆã‚‰ã‚Œã¾ã™ã€‚

```js
BinaryTree.stringToTree('x(y,a(,b))')
/*
BinaryTree {
  value: 'x',
  left: BinaryTree { value: 'y', left: null, right: null },
  right:
    BinaryTree {
      value: 'a',
      left: null,
      right: BinaryTree { value: 'b', left: null, right: null } } }
*/
```

#### å•68: äºŒåˆ†æœ¨ã‚’å‰é †ã«èµ°æŸ»ã™ã‚‹`preorder`é–¢æ•°ã¨ã€ä¸­é †ã«èµ°æŸ»ã™ã‚‹`inorder`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚ã¾ãŸã€å‰é †ã¨ä¸­é †ã«èµ°æŸ»ã—ãŸçµæœã‚’ç”¨ã„ã¦äºŒåˆ†æœ¨ã‚’ç”Ÿæˆã™ã‚‹`preInTree`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

å‰é †ã¨ä¸­é †ã§èµ°æŸ»ã—ãŸçµæœãŒã‚ã‚Œã°ã€äºŒåˆ†æœ¨ã®æœ¨æ§‹é€ ã¯ä¸€é€šã‚Šã«å®šã‚ã‚‰ã‚Œã¾ã™ã€‚

```js
const tree = BinaryTree.stringToTree('a(b(d,e),c(,f(g,)))')
tree.preorder // [ 'a', 'b', 'd', 'e', 'c', 'f', 'g' ]
tree.inorder  // [ 'd', 'b', 'e', 'a', 'c', 'g', 'f' ]
BinaryTree.preInTree(tree.preorder, tree.inorder)
/*
BinaryTree {
  value: 'a',
  left:
    BinaryTree {
      value: 'b',
      left: BinaryTree { value: 'd', left: null, right: null },
      right: BinaryTree { value: 'e', left: null, right: null } },
  right:
    BinaryTree {
      value: 'c',
      left: null,
      right:
        BinaryTree {
          value: 'f',
          left: BinaryTree { value: 'g', left: null, right: null },
          right: null } } }
*/
```

#### å•69: æ¬¡ã®ã‚ˆã†ãªæ–‡å­—åˆ—ã‚’äºŒåˆ†æœ¨ã«å¤‰æ›ã™ã‚‹`dotstrToTree`é–¢æ•°ã¨ã€é€†å¤‰æ›ã™ã‚‹`toDotstr`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

äºŒåˆ†æœ¨ã¯`'abd..e..c.fg...'`ã®ã‚ˆã†ãªæ–‡å­—åˆ—ã§è¡¨ç¾ã•ã‚Œã¦æ¸¡ã•ã‚Œã¾ã™ã€‚`.`ã¯`null`ã¨ã—ã€å„ãƒãƒ¼ãƒ‰ã«ã¯1æ–‡å­—ã—ã‹å…¥ã‚Šã¾ã›ã‚“ã€‚  
ã“ã‚Œã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦ã€æ¬¡ã®ã‚ˆã†ãªçµæœã«ãªã‚‹ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚

```js
const tree = BinaryTree.dotstrToTree('abd..e..c.fg...') // å•68ã®äºŒåˆ†æœ¨ã¨åŒã˜
tree.toDotstr // abd..e..c.fg...
```

### å•70ï½73: å¤šåˆ†æœ¨

#### å•70: å¤šåˆ†æœ¨ã‚¯ãƒ©ã‚¹`MultiwayTree`ã‚’å®Ÿè£…ã›ã‚ˆã€‚ãƒãƒ¼ãƒ‰ã®æ•°ã‚’è¿”ã™`count`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚ã¾ãŸã€æ¬¡ã®ã‚ˆã†ãªæ–‡å­—åˆ—è¡¨ç¾ã‚’å¤‰æ›ã™ã‚‹`stringToTree`é–¢æ•°ã¨ã€é€†å¤‰æ›ã™ã‚‹`treeToString`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

#### å•71: æ ¹ã‹ã‚‰å…¨ãƒãƒ¼ãƒ‰ã¾ã§ã®çµŒè·¯é•·ã®ç·å’Œã‚’æ±‚ã‚ã‚‹`ipl`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

#### å•72: ãƒœãƒˆãƒ ã‚¢ãƒƒãƒ—å¼ã«ãƒãƒ¼ãƒ‰ã‚’åˆ—æŒ™ã™ã‚‹`bottomUp`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

#### å•73: Lispã®ã‚ˆã†ãªæœ¨æ§‹é€ ã®æ–‡å­—åˆ—è¡¨ç¾ã‚’è¿”ã™`lisp`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚


### å•80ï½89: ã‚°ãƒ©ãƒ•

### å•90ï½94: ãã®ä»–ã®å•é¡Œ

#### å•90: [N-ã‚¯ã‚¤ãƒ¼ãƒ³å•é¡Œ](https://ja.wikipedia.org/wiki/%E3%82%A8%E3%82%A4%E3%83%88%E3%83%BB%E3%82%AF%E3%82%A4%E3%83%BC%E3%83%B3)ã‚’è§£ã`queens`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

#### å•91: [ãƒŠã‚¤ãƒˆãƒ»ãƒ„ã‚¢ãƒ¼å•é¡Œ](https://ja.wikipedia.org/wiki/%E3%83%8A%E3%82%A4%E3%83%88%E3%83%BB%E3%83%84%E3%82%A2%E3%83%BC)ã‚’è§£ã`knightsTour`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

n * nã®ãƒã‚§ã‚¹ç›¤ã®ä¸Šã‚’æŒ‡å®šã—ãŸãƒã‚¹ã«ç½®ã‹ã‚ŒãŸãƒŠã‚¤ãƒˆãŒå…¨ã¦ã®ãƒã‚¹ã‚’å·¡å›ã—ã€ãã®è¾¿ã£ãŸçµŒè·¯ã‚’é…åˆ—ã¨ã—ã¦è¿”ã—ã¾ã™ã€‚

### å•95ï½99: ãã®ä»–ã®å•é¡Œã€ç¶šã


## è§£ç­”ä¾‹ãƒ»è§£èª¬

è§£ç­”ä¾‹ã®è§£ãæ–¹ã¯çŸ­ãæ›¸ã“ã†ã¨ã—ã¦ã„ãŸã‚Šã€ä¸å¯§ã«æ›¸ã“ã†ã¨ã—ã¦ã„ãŸã‚Šã§ã€ãã®æ™‚ã®æ°—åˆ†ã«ã‚ˆã£ã¦ã¾ã¡ã¾ã¡ã§ã™ã€‚  
ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚‚è€ƒæ…®ã—ã¦ã„ã¾ã›ã‚“ã€‚  
å®Ÿéš›ã«è§£ãã¨ãã¯ç„¡ç†ã—ã¦çŸ­ãæ›¸ãã‚ˆã‚Šã‚‚ã€èª­ã¿æ‰‹ãŒåˆ†ã‹ã‚Šã‚„ã™ã„ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã‚ˆã†ã«ã—ã¾ã—ã‚‡ã†ã€‚

### å•1ï½10: é…åˆ—

#### å•1: é…åˆ—ã‚„æ–‡å­—åˆ—ã®æœ€å¾Œã®è¦ç´ ã‚’å–ã‚Šå‡ºã™`last`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const last = list => list[list.length - 1]

last([1, 2, 3, 4]) // 4
last('xyz') // z
```

é…åˆ—ã®`index`ã¯`0`ã‹ã‚‰é–‹å§‹ã™ã‚‹ãŸã‚ã€`é…åˆ—ã®é•·ã• - 1`ã§æœ€å¾Œã®è¦ç´ ãŒå–ã‚Œã¾ã™ã€‚  
JavaScriptã®å ´åˆã€å®šç¾©ã—ã¦ã„ãªã„è¦ç´ ã‚’å‚ç…§ã™ã‚‹ã¨`undefined`ãŒè¿”ã£ã¦ãã‚‹ã®ã§ã€ç©ºæ–‡å­—ã‚„ç©ºé…åˆ—ã®ã“ã¨ã¯ã‚ã¾ã‚Šè€ƒãˆãªãã¦ã‚‚ã„ã„ã§ã—ã‚‡ã†ã€‚

#### å•2: é…åˆ—ã‚„æ–‡å­—åˆ—ã®æœ€å¾Œã®ä¸€ã¤å‰ã®è¦ç´ ã‚’å–ã‚Šå‡ºã™`butLast`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const butLast = list => list[list.length - 2]

butLast([1, 2, 3, 4]) // 3
butLast('abcdefghijklmnopqrstuvwxyz') // y
```

å•1ã¨å¤§ä½“åŒã˜ã€‚

#### å•3: é…åˆ—ã‚„æ–‡å­—åˆ—ã®nç•ªç›®ã®è¦ç´ ã‚’å–ã‚Šå‡ºã™`elementAt`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

ãŸã ã—ã€æœ€åˆã®è¦ç´ ã¯0ç•ªç›®ã§ã¯ãªãã€1ç•ªç›®ã¨æ•°ãˆã¾ã™ã€‚

```js
const elementAt = (list, index) => list[index - 1]

elementAt([1, 2, 3], 2) // 2
elementAt('JavaScript', 5) // S
```

æ™®é€šã«é…åˆ—ã®è¦ç´ ã‚’å‚ç…§ã—ã¦ã„ã‚‹ã ã‘ãªã®ã§ã€`elementAt`é–¢æ•°ã‚’ä½œã‚‹æ„å‘³ã¯ç„¡ã„ã§ã™ã­ã€‚  
JavaScriptãªã®ã§`index out of bounds`ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ã‚‚æŠ•ã’ã‚‰ã‚Œã¾ã›ã‚“ã€‚

#### å•4: é…åˆ—ã‚„æ–‡å­—åˆ—ã®é•·ã•ã‚’è¿”ã™`length`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

`Array.length`ã‚„`String.length`ã¯ä½¿ç”¨ã—ãªã„ã“ã¨ã€‚  
ã¾ãŸã€çµµæ–‡å­—ã®é•·ã•ã¯`1`ã¨æ•°ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã€‚

```js
const length = list => [...list].fill(1).reduce((a, c) => a + c, 0)

length([123, 456, 789]) // 3
length('ğŸ’ƒHello, World!ğŸ’ƒ') // 15
```

æ–‡å­—åˆ—ã®æ–¹ã«ã¯çµµæ–‡å­—ãŒæ··ã–ã£ã¦ã„ã¾ã™ã€‚  
**çµµæ–‡å­—ã¯ã‚µãƒ­ã‚²ãƒ¼ãƒˆãƒšã‚¢ã§è¡¨ç¾ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€`length`ã§2æ–‡å­—æ‰±ã„ã«ãªã‚Šã¾ã™ã€‚**  
ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰æ¼”ç®—å­ã‚’ç”¨ã„ã‚‹ã¨ã€`[...'ğŸ’ƒHello!ğŸ’ƒ']`ã‚’`[ 'ğŸ’ƒ', 'H', 'e', 'l', 'l', 'o', '!', 'ğŸ’ƒ' ]`ã«ã§ãã‚‹ãŸã‚ã€`length`ã§æ­£ã—ã„é•·ã•ã‚’è¿”ã™ã“ã¨ãŒã§ãã¾ã™ã€‚

ã•ã¦ã€`length`ã®ä½¿ç”¨ãŒç¦æ­¢ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ãã®ä»£ã‚ã‚Šã¨ãªã‚‹æ–¹æ³•ã‚’è€ƒãˆãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚  
`fill`ã¯é…åˆ—ã®è¦ç´ ã‚’å…¨ã¦å¼•æ•°ã®å€¤ã«å¤‰æ›´ã—ã¦è¿”ã—ã¾ã™ã€‚`reduce`ã¯é…åˆ—ã®è¦ç´ ã‚’å·¦ã‹ã‚‰å³ã«èª­ã‚“ã§ã„ãã€ä½•ã‹å‡¦ç†ã‚’ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚  
ã¤ã¾ã‚Šã€`fill(1)`ã—ã¦ã‹ã‚‰`reduce`ã§è¶³ã›ã°ã€é…åˆ—ã®é•·ã•ãŒå–å¾—ã§ãã¾ã™ã€‚

#### å•5: é…åˆ—ã‚„æ–‡å­—åˆ—ã‚’é€†é †ã«ã—ã¦è¿”ã™`reverse`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

`Array.reverse`ã¯ä½¿ç”¨ã—ãªã„ã“ã¨ã€‚  
ã¾ãŸã€çµµæ–‡å­—ã®é•·ã•ã¯`1`ã¨æ•°ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã€‚

```js
const reverse = list => [...list].reduceRight(
  (a, c) => a.concat(c), Array.isArray(list) ? [] : '')

reverse('A man, a plan, a canal, panama!ğŸ’ƒ') // ğŸ’ƒ!amanap ,lanac a ,nalp a ,nam A
reverse([1, 2, 3, 4]) // [4, 3, 2, 1]
```

çµµæ–‡å­—ã®å‡¦ç†ã¯å•4ã¨åŒæ§˜ã§ã™ã€‚  
é…åˆ—ã®è¦ç´ ã‚’å³ã‹ã‚‰å·¦ã«çµåˆã—ã¦ã„ã‘ã°é€†ã«ãªã‚‹ãŸã‚ã€`reduceRight`ã‚’ç”¨ã„ã¾ã™ã€‚  
å¼•æ•°ãŒé…åˆ—ã®ã¨ãã¨æ–‡å­—åˆ—ã®ã¨ãã§çµæœã‚’å¤‰ãˆãŸã„ã®ã§ã€åˆæœŸå€¤ã‚’`Array.isArray(list) ? [] : ''`ã§åˆ†å²ã•ã›ã€`Array.concat`ã¾ãŸã¯`String.concat`ã§çµåˆã•ã›ã¦ã„ã¾ã™ã€‚


#### å•6: é…åˆ—ã‚„æ–‡å­—åˆ—ãŒå›æ–‡ã‹ã©ã†ã‹ã‚’è¿”ã™`isPalindrome`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const isPalindrome = list => list.toString() === reverse(list).toString()

isPalindrome([1, 2, 3]) // false
isPalindrome('ãŸã‘ã‚„ã¶ã‚„ã‘ãŸ') // true
isPalindrome([1, 2, 4, 8, 16, 8, 4, 2, 1]) // true
```

å•5ã®`reverse`ã‚’ä½¿ã†ã¨æ¥½ã«æ›¸ã‘ã¾ã™ã€‚  
é…åˆ—ã®å³å¯†ãªæ¯”è¼ƒã¯é¢å€’ãªã®ã§ã€`toString`ã—ã¦åŒã˜æ–‡å­—åˆ—ã«ãªã‚Œã°ã‚ˆã—ã¨ã—ã¾ã™ã€‚

#### å•7: ãƒã‚¹ãƒˆã—ã¦ã„ã‚‹é…åˆ—ã‚’å¹³å¦ï¼ˆä¸€æ¬¡å…ƒé…åˆ—ï¼‰ã«ã—ã¦è¿”ã™`flatten`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

`Array.flat`ã¯ä½¿ç”¨ã—ãªã„ã“ã¨ã€‚

```js
const flatten = list => list.reduce(
  (a, c) => a.concat(Array.isArray(c) ? flatten(c) : c), [])

flatten([1, [2, [3, 4], 5]]) // [1, 2, 3, 4, 5]
```

`reduce`ã‚’ä½¿ã„ã¾ã™ã€‚è¦ç´ ãŒé…åˆ—ãªã‚‰å†å¸°çš„ã«`flatten`ã‚’å‘¼ã‚“ã§ä¸€æ¬¡å…ƒé…åˆ—ã‚’è¿”ã—ã€`concat`ã§çµåˆã—ã¾ã™ã€‚

#### å•8: é…åˆ—ã‚„æ–‡å­—åˆ—ã‹ã‚‰åŒã˜è¦ç´ ã®ç¹°ã‚Šè¿”ã—ã‚’æ’é™¤ã—ã¦è¿”ã™`compress`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const compress = list => [...list].reduce(
  (a, c) => a.concat(a[a.length - 1] !== c ? c : []), 
  Array.isArray(list) ? [] : '')

compress([1, 1, 2, 1, 2, 2, 3, 3, 3, 3]) // [ 1, 2, 1, 2, 3 ]
compress('aaaabccaadeeee') // abcade
```

`reduce`ã‚’ä½¿ã„ã¾ã™ã€‚  
ã‚¢ã‚­ãƒ¥ãƒ ãƒ¬ãƒ¼ã‚¿`a`ã®æœ€å¾Œã®è¦ç´ ãŒç¾åœ¨å€¤`c`ã¨ç­‰ã—ããªã‘ã‚Œã°`c`ã‚’çµåˆã—ã€ç­‰ã—ã‘ã‚Œã°ä½•ã‚‚çµåˆã—ãªã„ã‚ˆã†ã«ã—ã¾ã™ã€‚

#### å•9: é…åˆ—ã‚„æ–‡å­—åˆ—ã®åŒã˜è¦ç´ ã®ç¹°ã‚Šè¿”ã—ã‚’é…åˆ—ã¨ã—ã¦ã¾ã¨ã‚ã¦è¿”ã™`pack`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const pack = list => {
  const isArray = Array.isArray(list)
  list = [...list]

  const result = []
  let element = null
  let current = null

  list.forEach((e, i) => {
    if (current === e) {
      element = element.concat(e)

    } else {
      if (element) { result.push(element) }
      current = e
      element = isArray ? [e] : e
    }

    if (i === (list.length - 1)) {
      result.push(element)
    }
  })

  return result
}

pack([1, 1, 2, 1, 2, 2, 3, 3, 3, 3]) // [[1, 1], [2], [1], [2, 2], [3, 3, 3, 3]]
pack('aaaabccaadeeee') // ['aaaa', 'b', 'cc', 'aa', 'd', 'eeee']
```

å°‘ã€…é•·ããªã£ã¦ã„ã¾ã™ã€‚ã‚‚ã£ã¨ã„ã„è§£æ³•ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚  
çµæœã®é…åˆ—`result`ã«æ ¼ç´ã—ãŸã„è¦ç´ `element`ã¨ã€ç¾åœ¨å¯¾è±¡ã¨ã—ã¦ã„ã‚‹å€¤`current`ã‚’å®£è¨€ã—ã¾ã™ã€‚  
`forEach`ã§ãƒ«ãƒ¼ãƒ—ã•ã›ã€`current`ã¨è¦ç´ ãŒç­‰ã—ã‘ã‚Œã°`element`ã¨çµåˆã•ã›ã€ç­‰ã—ããªã‘ã‚Œã°`current`ã¨`element`ã«æ–°ã—ã„å€¤ã‚’ã‚»ãƒƒãƒˆã—ã¾ã™ã€‚  
ãƒ«ãƒ¼ãƒ—ãŒæœ«å°¾ã®ã¨ãã¯ã€`element`ã‚’`result`ã«æ ¼ç´ã™ã‚‹ã®ã‚’å¿˜ã‚Œãšã«ã€‚

#### å•10: `pack`é–¢æ•°ã‚’ç”¨ã„ã¦ã€é…åˆ—ã‚„æ–‡å­—åˆ—ã‚’ãƒ©ãƒ³ãƒ¬ãƒ³ã‚°ã‚¹åœ§ç¸®ã™ã‚‹`encode`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const encode = list => pack(list).map(e => [e.length, e[0]])

encode([1, 1, 2, 1, 2, 2, 3, 3, 3, 3]) // [[2, 1], [1, 2], [1, 1], [2, 2], [4, 3]]
encode('aaaabccaadeeee')
// [[4, 'a'], [1, 'b'], [2, 'c'], [2, 'a'], [1, 'd'], [4, 'e']]
```

`map`ã§å„è¦ç´ ã®é•·ã•ã¨æœ€åˆã®è¦ç´ ã‚’æ ¼ç´ã—ãŸé…åˆ—ã«å¤‰æ›ã—ã¾ã™ã€‚

### å•11ï½20: é…åˆ—ã®ç¶šã

#### å•11: å•10ã®çµæœã‚’å¤‰æ›´ã—ã€é‡è¤‡ãŒç„¡ã‘ã‚Œã°ãƒ©ãƒ³ãƒ¬ãƒ³ã‚°ã‚¹åœ§ç¸®ã›ãšã«è¦ç´ ã‚’æ ¼ç´ã™ã‚‹`encodeModified`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const encodeModified = list => encode(list).map(e => e[0] === 1 ? e[1] : e)

encodeModified([1, 1, 2, 1, 2, 2, 3, 3, 3, 3]) // [[2, 1], 2, 1, [2, 2], [4, 3]]
encodeModified('aaaabccaadeeee')
// [[4, 'a'], 'b', [2, 'c'], [2, 'a'], 'd', [4, 'e']]
```

#### å•12: ãƒ©ãƒ³ãƒ¬ãƒ³ã‚°ã‚¹åœ§ç¸®ã—ãŸé…åˆ—ã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹`decodeModified`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const decodeModified = list => {
  const result = []
  
  list.forEach(e => {
    if (Array.isArray(e)) for (let i = 0; i < e[0]; i++) {
      result.push(e[1])
    } else {
      result.push(e)
    }
  })
  
  return typeof(result[0]) === 'string' ? result.join('') : result
}

decodeModified([[2, 1], 2, 1, [2, 2], [4, 3]]) // [1, 1, 2, 1, 2, 2, 3, 3, 3, 3]
decodeModified([[4, 'a'], 'b', [2, 'c'], [2, 'a'], 'd', [4, 'e']]) // aaaabccaadeeee
```

é…åˆ—ãªã‚‰1ç•ªç›®ã®è¦ç´ ã‚’é•·ã•ã®åˆ†ã ã‘æ ¼ç´ã—ã€ãã†ã§ãªã„ãªã‚‰è¦ç´ ã‚’ãã®ã¾ã¾é…åˆ—ã«æ ¼ç´ã—ã¾ã™ã€‚  
æ–‡å­—ã®é…åˆ—ã ã£ãŸå ´åˆã¯ã€æœ€å¾Œã«`join`ã§æ–‡å­—åˆ—ã«ã—ã¾ã™ã€‚æ–‡å­—ã¨æ•°å€¤ã®æ··åœ¨ã«ã¯å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚  

æ–‡å­—åˆ—ã‹ã©ã†ã‹ã®åˆ¤å®šã¯`typeof`ã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚  
`typeof`ã¯ã€å¼•æ•°ã®å‹ã‚’æ–‡å­—åˆ—ã§è¿”ã—ã¦ãã‚Œã¾ã™ã€‚

#### å•13: `pack`é–¢æ•°ã®ã‚ˆã†ã«é‡è¤‡ã‚’å«ã‚€é…åˆ—ã‚’ä½œã‚‰ãšã«ã€ç›´æ¥ãƒ©ãƒ³ãƒ¬ãƒ³ã‚°ã‚¹åœ§ç¸®ã™ã‚‹`encodeDirect`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const encodeDirect = list => {
  list = [...list]

  const result = []
  let count = 1
  let current = null

  const push = () => result.push(count > 1 ? [count, current] : current)

  list.forEach((e, i) => {
    if (current === e) {
      count++

    } else {
      if (current) { push() }
      count = 1
      current = e
    }

    if (i === (list.length - 1)) { push() }
  })

  return result
}

encodeDirect([1, 1, 2, 1, 2, 2, 3, 3, 3, 3]) // [[2, 1], 2, 1, [2, 2], [4, 3]]
encodeDirect('aaaabccaadeeee')
// [[4, 'a'], 'b', [2, 'c'], [2, 'a'], 'd', [4, 'e']]
```

`pack`é–¢æ•°ã‚’æ”¹é€ ã—ã¦ç›´æ¥ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚  
è¦ç´ ã®æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆã—ã¦ã€1å€‹ã—ã‹ãªã„ãªã‚‰ãã®è¦ç´ è‡ªä½“ã‚’ã€2å€‹ä»¥ä¸Šã‚ã‚‹ãªã‚‰ãƒ©ãƒ³ãƒ¬ãƒ³ã‚°ã‚¹åœ§ç¸®ã—ãŸçµæœã‚’æ ¼ç´ã—ã¾ã™ã€‚

#### å•14: é…åˆ—ã‚„æ–‡å­—åˆ—ã®è¦ç´ ã‚’è¤‡è£½ã™ã‚‹`dupli`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
dupli([1, 2, 3]) // [1, 1, 2, 2, 3, 3]
dupli('abc') // aabbcc
```

`repli`é–¢æ•°ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚’`dupli`é–¢æ•°ã®å‹•ä½œã«ã™ã‚‹ã®ã§ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™ã€‚

#### å•15: æŒ‡å®šã•ã‚ŒãŸå›æ•°ã ã‘é…åˆ—ã‚„æ–‡å­—åˆ—ã®è¦ç´ ã‚’è¤‡è£½ã™ã‚‹`repli`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const repli = (list, n = 2) => {
  const isStr = typeof(list) === 'string'
  list = [...list]
  const result = []

  list.forEach(e => { for (let i = 0; i < n; i++) result.push(e) })

  return isStr ? result.join('') : result
}

repli([1, 2, 3], 3) // [1, 1, 1, 2, 2, 2, 3, 3, 3]
repli('abc', 3) // aaabbbccc
```

`for`æ–‡ã§æŒ‡å®šã•ã‚ŒãŸå›æ•°åˆ†ã ã‘é…åˆ—ã«è¦ç´ ã‚’ç¹°ã‚Šè¿”ã—`push`ã—ã¾ã™ã€‚  
ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå¼•æ•°ã‚’ä¸ãˆã¦ã„ã‚‹ãŸã‚ã€ç¬¬äºŒå¼•æ•°ã‚’æ¸¡ã•ãªã‘ã‚Œã°`dupli`ã®å‹•ä½œã«ãªã‚Šã¾ã™ã€‚

#### å•16: é…åˆ—ã‚„æ–‡å­—åˆ—ã‹ã‚‰nã®å€æ•°ã®ä½ç½®ã®è¦ç´ ã‚’å‰Šé™¤ã™ã‚‹`drop`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const drop = (list, n) => ((ret = [...list].filter((_, i) => (i + 1) % n !== 0)) => 
  typeof(list) === 'string' ? ret.join('') : ret)()

drop([1, 2, 3, 4], 2) // [1, 3] 
drop('abcdefghik', 3) // 'abdeghk'
```

1è¡Œã§æ›¸ãå¿…è¦ã¯å…¨ãã‚ã‚Šã¾ã›ã‚“ãŒã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå¼•æ•°ã¨ã‚¢ãƒ­ãƒ¼é–¢æ•°ã‚’åˆ©ç”¨ã™ã‚Œã°1è¡Œã§è‰²ã€…ãªå‡¦ç†ã‚’ã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚  
`filter`ã§`index + 1`ãŒ`n`ã§å‰²ã‚Šåˆ‡ã‚Œã‚‹ãªã‚‰é™¤å¤–ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

#### å•17: é…åˆ—ã‚„æ–‡å­—åˆ—ã‚’æŒ‡å®šã—ãŸä½ç½®ã§åˆ†ã‘ã‚‹`split`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const split = (list, n) => ((x = [...list], ret = [x, x.splice(n)]) => 
  typeof(list) === 'string' ? ret.map(e => e.join('')) : ret)()

split([1, 2, 3, 4], 2) // [[1, 2], [3, 4]]
split('abcdefghik', 3) // ['abc', 'defghik']
```

`splice`ã‚’ä½¿ãˆã°ç°¡å˜ã«äºŒã¤ã«åˆ†ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚  
å…ƒã®é…åˆ—ã«ã‚‚å¤‰æ›´ã‚’åŠ ãˆã¦ã—ã¾ã†ã®ã§ã€ä½¿ã†éš›ã¯ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰æ¼”ç®—å­ãªã©ã§é…åˆ—ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãŠã„ãŸã»ã†ãŒå®‰å…¨ã§ã™ã€‚  
ãã®æ€§è³ªã‚’åˆ©ç”¨ã—ã¦ã€`[x, x.splice(n)]`ã§äºŒã¤ã«åˆ†ã‘ã¦ã„ã¾ã™ã€‚

#### å•18: é…åˆ—ã‚„æ–‡å­—åˆ—ã‹ã‚‰é¸æŠã—ãŸç¯„å›²ã‚’å–ã‚Šå‡ºã™`slice`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

`Array.slice`ã€`Array.splice`ã¯ä½¿ç”¨ã—ãªã„ã“ã¨ã€‚

```js
const slice = (list, start, end = list.length) => {
  let result = Array.isArray(list) ? [] : ''

  for (let i = start - 1; i < end; i++) {
    result = result.concat(list[i])
  }
  return result
}

slice([1, 2, 3, 4], 2, 4) // [2, 3, 4]
slice('abcdefghik', 3, 7) // cdefg
```

#### å•19: é…åˆ—ã‚„æ–‡å­—åˆ—ã®è¦ç´ ã‚’å·¦ã«nå€‹ãšã‚‰ã™`rotate`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

è² ã®æ•°ã‚’æ¸¡ã—ãŸã‚‰å³ã«ãšã‚‰ã™ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚

```js
const rotate = (list, n) => ((x = [...list], _ = x.unshift(...x.splice(n))) =>
  typeof(list) === 'string' ? x.join('') : x)()

rotate([1, 2, 3], 1) // [2, 3, 1]
rotate('abcdefgh', 3) // defghabc
rotate('abcdefgh', -2) // ghabcdef
```

å…ˆé ­ã«è¦ç´ ã‚’è¿½åŠ ã™ã‚‹`unshift`ã¨ã€é…åˆ—ã‹ã‚‰è¦ç´ ã‚’å–ã‚Šé™¤ã`splice`ã‚’çµ„ã¿åˆã‚ã›ã‚Œã°ç°¡å˜ã«å®Ÿè£…ã§ãã¾ã™ã€‚

#### å•20: é…åˆ—ã‚„æ–‡å­—åˆ—ã®nç•ªç›®ã®è¦ç´ ã‚’å‰Šé™¤ã™ã‚‹`removeAt`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

å‰Šé™¤ã—ãŸè¦ç´ ã¨å‡¦ç†å¾Œã®é…åˆ—ã‚’ã€é…åˆ—ã«æ ¼ç´ã—ã¦è¿”ã—ã¦ãã ã•ã„ã€‚

```js
const removeAt = (n, list) => ((x = [...list], removed = x.splice(n - 1, 1)[0]) => 
  [removed, typeof(list) === 'string' ? x.join('') : x])()

removeAt(3, [1, 2, 3]) // [3, [1, 2]]
removeAt(2, 'abcd') // ['b', 'acd']
```

`splice`ã®ç¬¬äºŒå¼•æ•°ã«æ•°å€¤ã‚’æ¸¡ã™ã¨ã€ãã®æ•°ã ã‘é–‹å§‹ä½ç½®ã‹ã‚‰å–ã‚Šé™¤ã‹ã‚Œã¾ã™ã€‚

### å•21ï½28: é…åˆ—ã€å†ã³

#### å•21: é…åˆ—ã‚„æ–‡å­—åˆ—ã®æŒ‡å®šã—ãŸä½ç½®ã«è¦ç´ ã‚’æŒ¿å…¥ã™ã‚‹`insertAt`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const insertAt = (element, list, n) => ((x = [...list], ret = x.concat(element, x.splice(n - 1))) => 
  typeof(list) === 'string' ? ret.join('') : ret)()

insertAt(5, [1, 2, 3, 4], 3) // [1, 2, 5, 3, 4]
insertAt('X', 'abcd', 2) // aXbcd
```

`concat`ã¨`splice`ã‚’çµ„ã¿åˆã‚ã›ã¦ã€æŒ‡å®šä½ç½®ã«`element`ã‚’æŒ¿å…¥ã—ã¾ã™ã€‚

#### å•22: æŒ‡å®šã•ã‚ŒãŸç¯„å›²å†…ã®ã™ã¹ã¦ã®æ•´æ•°ã¾ãŸã¯æ–‡å­—ã‚’å«ã‚€é…åˆ—ã‚’ç”Ÿæˆã™ã‚‹`range`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const range = (start, end) => {
  if (typeof(start) !== typeof(end)) {
    throw new Error('å¼•æ•°ã¯åŒã˜å‹ã«ã—ã¦ãã ã•ã„')
  }

  const isStr = typeof(start) === 'string'

  if (isStr && (start.length !== 1 || end.length !== 1)) {
    throw new Error('å¼•æ•°ã«ã™ã‚‹æ–‡å­—åˆ—ã®é•·ã•ã¯1ã«ã—ã¦ãã ã•ã„')
  }

  const list = []
  
  if (isStr) {
    start = start.charCodeAt(0)
    end = end.charCodeAt(0)
  }  

  for (let i = start; i <= end; i++) {
    list.push(isStr ? String.fromCharCode(i) : i)
  }

  return list
}

range(4, 9) // [4, 5 ,6, 7, 8, 9]
range('a', 'z') // ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z']
```

[è©¦ã—ã«1å•è§£ã„ã¦ã¿ã‚‹](#è©¦ã—ã«1å•è§£ã„ã¦ã¿ã‚‹)ã§è§£ç­”æ¸ˆã¿ã§ã™ã€‚  
æ–‡å­—åˆ—ã®å ´åˆã¯`String.charCodeAt`ã§æ•°å€¤åŒ–ã—ã€`start`ã¨`end`ã®ç¯„å›²å†…ã®æ–‡å­—ã‚’é…åˆ—ã«æ ¼ç´ã—ã¾ã™ã€‚

#### å•23: é…åˆ—ã‚„æ–‡å­—åˆ—ã‹ã‚‰æŒ‡å®šã•ã‚ŒãŸæ•°ã¶ã‚“ã ã‘ãƒ©ãƒ³ãƒ€ãƒ ã«è¦ç´ ã‚’å–ã‚Šå‡ºã™`rndSelect`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const rndSelect = (list, n) => {
  const isStr = typeof(list) === 'string'
  list = [...list]
  const result = []

  for (let i = 0; i < n && list.length > 0; i++) {
    const target = Math.floor(Math.random() * list.length)
    const removed = list.splice(target, 1)[0]
    result.push(removed)
  }
  return isStr ? result.join('') : result
}

rndSelect('abcdefgh', 3) // eda ãªã©
```

`Math.floor(Math.random() * n)`ã§ã€0ä»¥ä¸Šnæœªæº€ã®ä¹±æ•°ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚  
ã‚ã¨ã¯`splice`ã§é™¤å»ã—ãªãŒã‚‰çµæœã®é…åˆ—ã«æ ¼ç´ã—ã¦ã„ãã¾ã™ã€‚  
ã“ã®å ´åˆã€æ¡ä»¶æ–‡ã«`list.length > 0`ã‚’åŠ ãˆãªã„ã¨ã€`rndSelect([1, 2, 3], 10)`ãªã©ã®å ´åˆã«`undefined`ã‚’å«ã‚€é•·ã•10ã®é…åˆ—ãŒè¿”ã£ã¦ãã¦ã—ã¾ã„ã¾ã™ã€‚

#### å•24: é•·ã•nã®1ä»¥ä¸Šmä»¥ä¸‹ã®ä¹±æ•°åˆ—ã‚’ç”Ÿæˆã™ã‚‹`diffSelect`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const diffSelect = (length, max) => {
  if (max < 1) { throw new Error('æœ€å¤§å€¤ã¯1ä»¥ä¸Šã®å€¤ã‚’æŒ‡å®šã—ã¦ãã ã•ã„') }
  const result = []

  for (let i = 0; i < length; i++) {
    result.push(Math.floor(Math.random() * max) + 1)
  }
  return result
}

diffSelect(6, 49) // [23, 1, 17, 33, 21, 37] ãªã©
```

å•é¡Œ23ã§æ‰±ã£ãŸ`Math.floor(Math.random() * max)`ã«1ã‚’è¶³ã™ã¨1ä»¥ä¸Š`max`ä»¥ä¸‹ã®ä¹±æ•°ã«ãªã‚Šã¾ã™ã€‚

#### å•25: é…åˆ—ã‚„æ–‡å­—åˆ—ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«ä¸¦ã³æ›¿ãˆã‚‹`rndPermu`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const rndPermu = list => rndSelect(list, list.length)
rndPermu('abcdef') // badcef ãªã©
```

å®šç¾©æ¸ˆã¿ã®`rndSelect`ã‚’ä½¿ãˆã°ã™ãã«å®šç¾©ã§ãã¾ã™ã€‚

#### å•26: må€‹ã®è¦ç´ ã‹ã‚‰nå€‹ã‚’é¸ã‚“ã çµ„ã¿åˆã‚ã›ã‚’è¿”ã™`combinations`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const combinations = (list, n) => {
  if (n < 0 || list.length < n) throw new Error('ä¸æ­£ãªå¼•æ•°ã§ã™')
  if (n === 0) return [null]

  const isStr = typeof(list) === 'string'
  if (n === 1) return isStr ? [...list] : [...list].map(e => [e])
  
  const result = []
  n--

  for (let i = 0; i < list.length - n; i++) {
    const combi = combinations(list.slice(i + 1), n)

    for (let j = 0; j < combi.length; j++){
      const concatenated = [list[i]].concat(combi[j])
      result.push(isStr ? concatenated.join('') : concatenated)
    }
  }

  return result
}

combinations('abcdef', 3) 
// ['abc', 'abd', 'abe', 'abf', 'acd', 'ace', 'acf', 'ade', 'adf', 'aef', 'bcd', 'bce', 'bcf', 'bde', 'bdf', 'bef', 'cde', 'cdf', 'cef', 'def']
```

é«˜æ ¡ä¸€å¹´ç”Ÿãã‚‰ã„ã§ç¿’ã†çµ„ã¿åˆã‚ã›ã§ã™ã€‚  

`0`ã®å ´åˆã¯ã€ä½•ã‚‚é¸ã°ãªã„ã®ã§`null`ã‚’å…¥ã‚ŒãŸé…åˆ—ã‚’è¿”ã—ã¾ã™ã€‚  
`1`ã®å ´åˆã¯å„è¦ç´ ã‚’é¸ã¶ã®ã§ã€ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰æ¼”ç®—å­ã§ãƒãƒ©ã—ã¾ã™ã€‚  

`2`ä»¥ä¸Šã®å ´åˆã¯å†å¸°çš„ã«`combinations`ã‚’é©ç”¨ã—ã¾ã—ã‚‡ã†ã€‚  
ä¾‹ãˆã°`abcd`ã§`2`ã®ã¨ãã€`a`ã«`b, c, d`ã€`b`ã«`c, d`ã€`c`ã«`d`ã‚’çµåˆã™ã‚Œã°çµ„ã¿åˆã‚ã›`['ab', 'ac', 'ad', 'bc', 'bd', 'cd']`ãŒå‡ºã¾ã™ã€‚  
`3`ã®ã¨ãã€`a`ã«`b, c, d`ã‹ã‚‰`2`å€‹é¸ã‚“ã çµ„ã¿åˆã‚ã›`bc, bd, cd`ã¨ã€`b`ã«`c, d`ã‹ã‚‰`2`å€‹é¸ã‚“ã çµ„ã¿åˆã‚ã›`cd`ã‚’çµåˆã™ã‚Œã°`['abc', 'abd', 'acd', 'bcd']`ãŒå‡ºã¾ã™ã€‚  
ã¤ã¾ã‚Šã€`i`ç•ªç›®ã®è¦ç´ ã«å¾Œç¶š(`i + 1`ä»¥é™)ã®è¦ç´ ã‚’`n - 1`å€‹é¸ã‚“ã çµ„ã¿åˆã‚ã›ã‚’çµåˆã™ã‚Œã°ã€çµ„ã¿åˆã‚ã›ã‚’å°å‡ºã§ãã¾ã™ã€‚

#### å•27: é…åˆ—ã®è¦ç´ ã‚’äº’ã„ã«ç´ ãªé…åˆ—ã«ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã—ã¦è¿”ã™`group`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const exCombinations = (list, n) => {
  const isStr = typeof(list) === 'string'

  if (n === 0) return [isStr ? '' : [], list]
  if (list.length === 0) return []

  if (n === 1) return [...list].map((_, i) => {
    let r = [...list]
    r = [r.splice(i, 1), r]
    return isStr ? r.map(e => e.join('')) : r
  })

  const result = []
  const [x, ...xs] = list
  
  exCombinations(isStr ? xs.join('') : xs, n - 1).forEach(
    ([ys, zs]) => result.push([isStr ? x + ys : [x].concat(ys), zs]))

  exCombinations(isStr ? xs.join('') : xs, n).forEach(
    ([ys, zs]) => result.push([ys, isStr ? x + zs : [x].concat(zs)]))

  return result
}

const group = (list, ...numbers) => {
  if (list.length === 0) return [[]]

  const [n, ...ns] = numbers
  const result = []

  exCombinations(list, n).forEach(([g, rs]) =>
    group(rs, ...ns).forEach(e => result.push([g].concat(e))))

  return result
}

group(["aldo","beat","carla","david","evi","flip","gary","hugo","ida"], 2, 3, 4)
// [[["aldo","beat"],["carla","david","evi"],["flip","gary","hugo","ida"]],...] 1260å€‹ã®è§£
group(["aldo","beat","carla","david","evi","flip","gary","hugo","ida"], 2, 2, 5)
// [[["aldo","beat"],["carla","david"],["evi","flip","gary","hugo","ida"]],...] 756å€‹ã®è§£
```

ã¾ãšã€é¸æŠã•ã‚Œãªã‹ã£ãŸè¦ç´ ã‚‚ä¸€ç·’ã«è¿”ã™`exCombinations`é–¢æ•°ã‚’å®šç¾©ã—ã¾ã™ã€‚  
çµæœã¯`[é¸ã‚“ã ã‚‚ã®ã®é…åˆ—, é¸ã°ãªã‹ã£ãŸã‚‚ã®ã®é…åˆ—]`ã®æ§‹é€ ã«ã—ã¾ã™ã€‚

å†å¸°ã•ã›ã‚‹ã®ã§ã€å†å¸°ã‚’æŠœã‘ã‚‹ãŸã‚ã®æ¡ä»¶æ–‡ã¯æœ€åˆã«æ›¸ã„ã¦ãŠãã¾ã—ã‚‡ã†ã€‚  
`n === 1`ã®ã¨ãã¯ã€é…åˆ—ã®å…¨ã¦ã®è¦ç´ ãŒé¸æŠã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

`exCombinations`ã¯ã€æœ€åˆã®è¦ç´ ã‚’é¸ã¶å ´åˆã¨ã€é¸ã°ãªã„å ´åˆã‚’è€ƒæ…®ã—ã¦å†å¸°ã•ã›ã¾ã™ã€‚  
`exCombinations`ãŒã©ã†å‘¼ã°ã‚Œã‚‹ã®ã‹ä¾‹ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```js
exCombinations([1,2,3,4], 2)
exCombinations([2,3,4], 1) // [ [ [ 2 ], [ 3, 4 ] ], [ [ 3 ], [ 2, 4 ] ], [ [ 4 ], [ 2, 3 ] ] ]
exCombinations([2,3,4], 2) // [ [ [ 2, 3 ], [ 4 ] ], [ [ 2, 4 ], [ 3 ] ], [ [ 3, 4 ], [ 2 ] ] ]
```

æœ€åˆã®è¦ç´ ã‚’`x`ã€å¾Œç¶šã™ã‚‹è¦ç´ ã‚’`xs`ã¨ã—ã¾ã™ã€‚  
æœ€åˆã®è¦ç´ `x`ã‚’é¸ã‚“ã å ´åˆã€`xs`ã‹ã‚‰æ®‹ã‚Šã®`n - 1`å€‹ã®è¦ç´ ã‚’é¸æŠã™ã‚Œã°`n`å€‹é¸ã‚“ã ã“ã¨ã«ãªã‚Šã¾ã™ã€‚  
çµæœã¯`[é¸ã‚“ã ã‚‚ã®ã®é…åˆ—, é¸ã°ãªã‹ã£ãŸã‚‚ã®ã®é…åˆ—]`ã«ãªã£ã¦ã„ã‚‹ãŸã‚ã€çµæœã®0ç•ªç›®ã«`x`ã‚’çµåˆã•ã›ã¾ã™ã€‚

`x`ã‚’é¸ã°ãªã‹ã£ãŸå ´åˆã€`xs`ã‹ã‚‰æ®‹ã‚Šã®`n`å€‹ã®è¦ç´ ã‚’é¸æŠã™ã‚Œã°`n`å€‹é¸ã‚“ã ã“ã¨ã«ãªã‚Šã¾ã™ã€‚  
`x`ã¯çµæœã®é…åˆ—ã®1ç•ªç›®ã«çµåˆã•ã›ã¾ã™ã€‚

ã“ã‚Œã‚’å†å¸°çš„ã«å‘¼ã¶ã¨ã€é…åˆ—ã‹ã‚‰`n`å€‹é¸ã‚“ã çµ„ã¿åˆã‚ã›ã¨é¸ã°ãªã‹ã£ãŸçµ„ã¿åˆã‚ã›ã‚’å–å¾—ã§ãã¾ã™ã€‚

è‚å¿ƒã®`group`ã§ã™ãŒã€é¸ã‚“ã çµ„ã¿åˆã‚ã›ã«ã€é¸ã°ãªã‹ã£ãŸçµ„ã¿åˆã‚ã›ã®ã‚°ãƒ«ãƒ¼ãƒ—ã‚’çµåˆã—ã¦ã„ã‘ã°ç”Ÿæˆã§ãã¾ã™ã€‚  

#### å•28: é…åˆ—ã®é…åˆ—ã‚’ã€è¦ç´ ã®é•·ã•ã§ã‚½ãƒ¼ãƒˆã™ã‚‹`lsort`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚ã¾ãŸã€è¦ç´ ã®é•·ã•ã®é »åº¦é †ã«ã‚½ãƒ¼ãƒˆã™ã‚‹`lfsort`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const lsort = list => list.sort((a, b) => a.length - b.length)
lsort(["abc","de","fgh","de","ijkl","mn","o"]) // ["o","de","de","mn","abc","fgh","ijkl"]
```

```js
const lfsort = list => {
  const map = new Map(encode(list.map(e => e.length).sort()).map(([value, key]) => [key, value]))
  return list.sort((a, b) => map.get(a.length) - map.get(b.length))
}
lfsort(["abc", "de", "fgh", "de", "ijkl", "mn", "o"]) // ["ijkl","o","abc","fgh","de","de","mn"]
```

`sort`ã‚’ä½¿ãˆã°ç°¡å˜ã«é•·ã•ã®æ˜‡é †ã«ã‚½ãƒ¼ãƒˆã§ãã¾ã™ã€‚  
`sort`ã«ã¯æ¯”è¼ƒé–¢æ•°ã‚’æ¸¡ã™ã®ã§ã™ãŒã€ã“ã®é–¢æ•°ã®æˆ»ã‚Šå€¤ãŒ0æœªæº€ãªã‚‰`a`ã‚’`b`ã‚ˆã‚Šå‰ã«ã€0ãªã‚‰å¤‰æ›´ãªã—ã€0ã‚ˆã‚Šå¤§ãã„ãªã‚‰`b`ã‚’`a`ã‚ˆã‚Šå‰ã«ç§»å‹•ã—ã¾ã™ã€‚  
ã¤ã¾ã‚Šã€å‰ã®è¦ç´ ã®é•·ã•ã‹ã‚‰æ¬¡ã®è¦ç´ ã®é•·ã•ã‚’å¼•ã‘ã°ã€ã©ã¡ã‚‰ãŒé•·ã„ã‹åˆ†ã‹ã‚Šã¾ã™ã€‚

é »åº¦é †ã«ã‚½ãƒ¼ãƒˆã™ã‚‹ã«ã¯ã€å‰ã«ä½œã£ãŸãƒ©ãƒ³ãƒ¬ãƒ³ã‚°ã‚¹åœ§ç¸®ã™ã‚‹`encode`é–¢æ•°ã‚’ä½¿ã†ã¨æ¥½ã«ã§ãã¾ã™ã€‚é•·ã•ã®é…åˆ—ã‚’æ˜‡é †ã‚½ãƒ¼ãƒˆã—ãŸã‚‚ã®ã‚’ãƒ©ãƒ³ãƒ¬ãƒ³ã‚°ã‚¹åœ§ç¸®ã—ã¾ã—ã‚‡ã†ã€‚  
é•·ã•ã‚’`key`ã€é »åº¦ã‚’`value`ã«ã—ã¦`Map`ã«æ ¼ç´ã—ãŸã„ã®ã§ã€ãã®ã‚ˆã†ã«å…¥ã‚Œæ›¿ãˆã¦ãŠãã¾ã™ã€‚  
ã‚ã¨ã¯ç”Ÿæˆã—ãŸ`Map`ã‹ã‚‰ã€é•·ã•ã‚’`key`ã«ã—ã¦é »åº¦ã‚’å‚ç…§ã—ãªãŒã‚‰ã‚½ãƒ¼ãƒˆã™ã‚Œã°ã‚ˆã„ã§ã—ã‚‡ã†ã€‚

### å•31ï½41: ç®—è¡“

#### å•31: å¼•æ•°ãŒç´ æ•°ã‹ã©ã†ã‹ã‚’è¿”ã™`isPrime`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const isPrime = (n, loop = 100) => {
  if (n === 2) return true
  if (n <= 1 || n % 2 === 0) return false

  let d = (n - 1) >> 1
  while (d % 2 === 0) { d >>= 1 }

  const pow = (base, power, mod) => {
    let result = 1
    
    while (power > 0) {
      if (power % 2 === 1) { result = (result * base) % mod }
      base = (base ** 2) % mod
      power >>= 1
    }
    return result
  }

  for (let i = 0; i < loop; i++) {
    const rand = Math.floor(Math.random() * (n - 1) + 1)
    let t = d
    let y = pow(rand, t, n)

    while ((t !== (n - 1)) && (y !== 1) && (y !== (n - 1))) {
      y = (y ** 2) % n
      t <<= 1
    }

    if ((y !== (n - 1)) && (t % 2 === 0)) return false
  }

  return true
}

isPrime(7) // true
```

ç´ æ•°åˆ¤å®šã¯[ã‚¨ãƒ©ãƒˆã‚¹ãƒ†ãƒã‚¹ã®ç¯©](https://ja.wikipedia.org/wiki/%E3%82%A8%E3%83%A9%E3%83%88%E3%82%B9%E3%83%86%E3%83%8D%E3%82%B9%E3%81%AE%E7%AF%A9)ãŒå˜ç´”ã§å®Ÿè£…ã—ã‚„ã™ã„ã§ã™ã€‚  
ä»Šå›ã¯[ãƒŸãƒ©ãƒ¼â€“ãƒ©ãƒ“ãƒ³ç´ æ•°åˆ¤å®šæ³•](https://ja.wikipedia.org/wiki/%E3%83%9F%E3%83%A9%E3%83%BC%E2%80%93%E3%83%A9%E3%83%93%E3%83%B3%E7%B4%A0%E6%95%B0%E5%88%A4%E5%AE%9A%E6%B3%95)ã§å®Ÿè£…ã—ã¾ã—ãŸã€‚

è§£ç­”ã®ã‚³ãƒ¼ãƒ‰ã¯ã€Wikipediaã®è¨˜äº‹ã®Rubyã®ã‚³ãƒ¼ãƒ‰ã‚’JavaScriptã«ç¿»è¨³ã—ãŸã‚‚ã®ã«ãªã£ã¦ã„ã¾ã™ã€‚  
ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«é–¢ã—ã¦ã¯ã€[ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¨å®Ÿè¡Œæ™‚é–“](https://ja.wikipedia.org/wiki/%E3%83%9F%E3%83%A9%E3%83%BC%E2%80%93%E3%83%A9%E3%83%93%E3%83%B3%E7%B4%A0%E6%95%B0%E5%88%A4%E5%AE%9A%E6%B3%95#%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0%E3%81%A8%E5%AE%9F%E8%A1%8C%E6%99%82%E9%96%93)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚  
ãŸã ã—ã€ç¢ºç‡çš„ç´ æ•°åˆ¤å®šæ³•ãªã®ã§ã€æ¥µã€…ä½ç¢ºç‡ã§ç´ æ•°ã§ãªã„ã‚‚ã®ã‚’ç´ æ•°ã¨åˆ¤å®šã—ã¦ã—ã¾ã†ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

è£œè¶³ã§ã™ãŒã€`(d & 1) === 0`ã¯`d % 2 === 0`ã¨åŒã˜ã§ã™ã€‚å¥‡æ•°ã¯`2n + 1`ãªã®ã§ã€äºŒé€²è¡¨ç¾ã®1æ¡ç›®ãŒ0ãªã‚‰å¶æ•°ã€1ãªã‚‰å¥‡æ•°ã¨ãªã‚Šã¾ã™ã€‚  
ä¾‹ãˆã°ã€`0b1011 & 1`ã¯`1`ã§å¥‡æ•°ã€`0b1010 & 1`ã¯`0`ã§å¶æ•°ã¨ãªã‚Šã¾ã™ã€‚  
JavaScriptã§ã¯`&`æ¼”ç®—å­ã®å„ªå…ˆåº¦ãŒ`===`ã‚ˆã‚Šä½ã„ã®ã§ã€ä½¿ç”¨ã™ã‚‹éš›ã¯æ³¨æ„ã—ã¾ã—ã‚‡ã†ã€‚

#### å•32: [ãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰ã®äº’é™¤æ³•](https://ja.wikipedia.org/wiki/%E3%83%A6%E3%83%BC%E3%82%AF%E3%83%AA%E3%83%83%E3%83%89%E3%81%AE%E4%BA%92%E9%99%A4%E6%B3%95)ã‚’ä½¿ã£ã¦æœ€å¤§å…¬ç´„æ•°ã‚’æ±‚ã‚ã‚‹`gcd`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const gcd = (a, b) => b === 0 ? Math.abs(a) : gcd(b, a % b)
gcd(36, 63) // 9
```

ä¾‹ãˆã°`a`ã¨`b`ã®æœ€å¤§å…¬ç´„æ•°ã‚’æ±‚ã‚ã‚‹ã¨ã`gcd(a, b)`ã¯ã€

- `b === 0`ãªã‚‰`a`ã®çµ¶å¯¾å€¤ã‚’è¿”ã™
- ãã†ã§ãªã„ãªã‚‰æ¬¡ã®å‡¦ç†ã‚’è¡Œã†
  - `b`ã‚’æ–°ã—ã„`a`ã¨ã™ã‚‹
  - `a`ã‚’`b`ã§å‰²ã£ãŸä½™ã‚Šã‚’æ–°ã—ã„`b`ã¨ã™ã‚‹
  - `gcd(a, b)`ã‚’å‘¼ã¶

ã®ã‚ˆã†ã«å®Ÿè£…ã™ã‚Œã°ãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰ã®äº’é™¤æ³•ã«ã‚ˆã£ã¦æœ€å¤§å…¬ç´„æ•°ã‚’æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚  
`a >= b`ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ãŒã€`a < b`ã®ã¨ãã¯`a`ã‚’`b`ã§å‰²ã£ãŸä½™ã‚Šã‚’ç®—å‡ºã™ã‚‹ã¨`a`ã«ãªã‚‹ã®ã§ã€çµæœçš„ã«`a`ã¨`b`ã‚’å…¥ã‚Œæ›¿ãˆã¦å†å¸°å‘¼ã³å‡ºã—ã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

#### å•33: æ¸¡ã—ãŸ2ã¤ã®æ•´æ•°ãŒäº’ã„ã«ç´ ã‹ã©ã†ã‹ã‚’è¿”ã™`coprime`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const coprime = (a, b) => gcd(a, b) === 1
coprime(35, 64) // true
```

`a`ã¨`b`ã‚’å…±ã«å‰²ã‚Šåˆ‡ã‚‹æ•´æ•°ãŒ`1`ã®ã¿ã€ã¤ã¾ã‚Šæœ€å¤§å…¬ç´„æ•°ãŒ`1`ã®å ´åˆã¯`a`ã¨`b`ãŒäº’ã„ã«ç´ ã¨ãªã£ã¦ã„ã¾ã™ã€‚  
å•32ã®`gcd`é–¢æ•°ã‚’åˆ©ç”¨ã—ã¦ã€æˆ»ã‚Šå€¤ãŒ`1`ãªã‚‰äº’ã„ã«ç´ ã§ã‚ã‚‹ã¨åˆ¤åˆ¥ã—ã¾ã™ã€‚

#### å•34: [ã‚ªã‚¤ãƒ©ãƒ¼ã®Ï†é–¢æ•°](https://ja.wikipedia.org/wiki/%E3%82%AA%E3%82%A4%E3%83%A9%E3%83%BC%E3%81%AE%CF%86%E9%96%A2%E6%95%B0)`totient`ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const totient = n => n === 1 ? 1 : [...Array(n - 1)].map((_, i) => i + 1).filter(e => coprime(n, e)).length
totient(10) // 4
```

`1`ã‹ã‚‰`n`ã¾ã§ã®è‡ªç„¶æ•°ã®ã†ã¡ã€`n`ã¨äº’ã„ã«ç´ ãªã‚‚ã®ã®å€‹æ•°ãŒÏ†é–¢æ•°ã®æˆ»ã‚Šå€¤ã«ãªã‚Šã¾ã™ã€‚  
`[...Array(n - 1)].map((_, i) => i + 1)`ã‚’ã™ã‚‹ã¨`1..(n - 1)`ã®é…åˆ—ãŒç”Ÿæˆã§ãã‚‹ã®ã§ã€ãã‚Œã‚’`coprime`é–¢æ•°ã§ãƒ•ã‚£ãƒ«ã‚¿ã—ã¦ã‹ã‚‰è¦ç´ ã®å€‹æ•°ã‚’å–å¾—ã—ã¦ã„ã¾ã™ã€‚


#### å•35: å¼•æ•°ã‚’ç´ å› æ•°åˆ†è§£ã™ã‚‹`primeFactors`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

çµæœã¯æ˜‡é †ã«ã‚½ãƒ¼ãƒˆã™ã‚‹ã“ã¨ã€‚

```js
const primeFactors = n => ((f = ((a, b = 2) =>
  (a < b ** 2) ? [a] 
  : (a % b === 0) ? [b].concat(f(a / b, b))
  : f(a, b + 1)
)) => f(n))()

primeFactors(315) // [3, 3, 5, 7]
```

ä¸ãˆã‚‰ã‚ŒãŸè‡ªç„¶æ•°`n`ã‚’`2`ã‹ã‚‰é †ã«å‰²ã£ã¦ã„ãã€å‰²ã‚Šåˆ‡ã‚Œãªããªã‚‹ã¾ã§è¨ˆç®—ã—ã¾ã™ã€‚  

å‡¦ç†ã—ã¦ã„ã‚‹å€¤`a`ã¨ã€å‰²ã‚‹ã®ã«ç”¨ã„ã‚‹ç¾åœ¨å€¤`b`ã‚’å¼•æ•°ã«ã¨ã‚‹`f`ã‚’å®šç¾©ã—ã¾ã™ã€‚  
`a`ã¯`sqrt(a)`ã‚ˆã‚Šå¤§ãã„æ•°ã§ã¯å‰²ã‚Šåˆ‡ã‚Œãªã„ãŸã‚ã€ãã®å ´åˆã¯`a`ã‚’é…åˆ—ã«è©°ã‚ã¦è¿”ã—ã¾ã™ã€‚  
`a`ãŒ`b`ã§å‰²ã‚Šåˆ‡ã‚Œã‚‹ãªã‚‰ã€`b`ã¨`f(a / b, b)`ã‚’çµåˆã—ã¾ã™ã€‚  
ãã‚Œä»¥å¤–ã®å ´åˆã¯ã€å‰²ã‚‹ã®ã«ç”¨ã„ã‚‹æ•°å€¤ã‚’1é€²ã‚ã¦å†å¸°ã—ã¾ã™ã€‚  
`4`ã‚„`10`ãªã©ã‚‚`b`ã«å…¥ã‚Šã¾ã™ãŒã€äº‹å‰ã«ãã®è‡ªç„¶æ•°ã¾ã§ã®ç´ æ•°ã§å‰²ã£ã¦ã„ã‚‹å ´åˆã¯å‰²ã‚Šåˆ‡ã‚Œãªã„ãŸã‚ã€ç´ æ•°ã—ã‹çµæœã®é…åˆ—ã«ã¯å…¥ã‚Šã¾ã›ã‚“ã€‚

#### å•36: å•35ã®çµæœã‚’ç´¯ä¹—ã§è¡¨ç¾ã™ã‚‹`primeFactorsMult`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

`3 ** 2`ãªã‚‰`[3, 2]`ã¨è¡¨ç¾ã—ã¾ã™ã€‚

```js
const primeFactorsMult = n => ((factors = primeFactors(n)) => 
  factors.filter((e, i, self) => self.indexOf(e) === i)
    .map(e => [e, factors.filter(v => e === v).length])
)()

primeFactorsMult(315) // [[3, 2], [5, 1], [7, 1]]
```

å…ˆã»ã©å®šç¾©ã—ãŸ`primeFactors`é–¢æ•°ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚  

ã¾ãšã€é‡è¤‡ãªã—ã®é…åˆ—ã‚’`filter((e, i, self) => self.indexOf(e) === i)`ã§ä½œã‚Šã¾ã™ã€‚  
ã“ã‚Œã¯ã€è¦ç´ ã®ä½ç½®ã¨è¦ç´ ã®æ¤œç´¢ä½ç½®ãŒä¸€è‡´ã—ã¦ã„ãªã„è¦ç´ ï¼ˆé‡è¤‡è¦ç´ ï¼‰ãŒã‚ã‚Œã°æ’é™¤ã™ã‚‹å‡¦ç†ã«ãªã£ã¦ã„ã¾ã™ã€‚  
ãã®å¾Œã€`map(e => [e, factors.filter(v => e === v).length])`ã§è¦ç´ ã¨å€‹æ•°ã‚’ãƒšã‚¢ã«ã—ãŸé…åˆ—ã‚’ä½œæˆã—ã¾ã™ã€‚  
ã“ã‚Œã§ã€`primeFactors`ã®çµæœã‚’`[[åº•, æŒ‡æ•°], ...]`ã®å½¢ã«å¤‰æ›ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

#### å•37: ã‚ªã‚¤ãƒ©ãƒ¼ã®Ï†é–¢æ•°ã‚’æ”¹è‰¯ã—ãŸ`phi`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

å•36ã®çµæœã‚’`[[p1, m1], [p2, m2], [p3, m3], ...]`ã¨ã—ãŸã¨ãã€ã‚ªã‚¤ãƒ©ãƒ¼ã®Ï†é–¢æ•°ã¯æ¬¡ã®ã‚ˆã†ã«ã—ã¦è¨ˆç®—ã§ãã¾ã™ã€‚

```
phi(m) = (p1 - 1) * p1 ** (m1 - 1) * 
         (p2 - 1) * p2 ** (m2 - 1) * 
         (p3 - 1) * p3 ** (m3 - 1) * ...
```

```js
const phi = n => primeFactorsMult(n).map(([p, m]) => (p - 1) * p ** (m - 1)).reduce((a, c) => a * c)
phi(10) // 4
```

å…ˆã»ã©å®šç¾©ã—ãŸ`primeFactorsMult`é–¢æ•°ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚  
`map`ã§æ•°å¼ã®å½¢ã«åˆã‚ã›ã¦`reduce`ã§æ›ã‘åˆã‚ã›ã‚‹ã ã‘ã§è¨ˆç®—ã§ãã¾ã™ã€‚

#### å•38: å•34ã¨å•37ã®å®Ÿè¡Œæ™‚é–“ã‚’æ¯”è¼ƒã›ã‚ˆã€‚

`totient(10090)`ã¨`phi(10090)`ã‚’å®Ÿè¡Œã—ã¦ã€`phi`é–¢æ•°ã®ã»ã†ãŒåŠ¹ç‡çš„ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºã‹ã‚ã¦ãã ã•ã„ã€‚  
ã›ã£ã‹ããªã®ã§ã€é–¢æ•°ã®å®Ÿè¡Œæ™‚é–“ã‚’è¨ˆæ¸¬ã™ã‚‹`time`é–¢æ•°ã‚’å®Ÿè£…ã—ã¦èª¿ã¹ã¾ã—ã‚‡ã†ã€‚

```js
const time = (f, ...args) => {
  const perf = typeof(performance) === 'undefined' ? require('perf_hooks').performance : performance

  const t0 = perf.now()
  f(...args)
  const t1 = perf.now()
  
  return t1 - t0
}

time(totient, 10090) < time(phi, 10090) // true
```

ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’è¨ˆæ¸¬ã™ã‚‹ã«ã¯`performance.now`ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚  
Node.jsã§å®Ÿè¡Œã™ã‚‹éš›ã¯ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«å®šç¾©ã•ã‚Œã¦ã„ãªã„ã®ã§ã€`perf_hooks`ã‹ã‚‰`require`ã‚‚ã—ãã¯`import`ã—ã¾ã—ã‚‡ã†ã€‚

#### å•39: ä¸ãˆã‚‰ã‚ŒãŸç¯„å›²å†…ã®ç´ æ•°ã®é…åˆ—ã‚’è¿”ã™`primesR`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const primesR = (min, max) => [...Array(max - min + 1)].map((_, i) => i + min).filter(e => isPrime(e))
primesR(10, 20) // [11, 13, 17, 19]
```

`isPrime`é–¢æ•°ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚  
ä¸‹é™ã¨ä¸Šé™ã‚’å«ã‚ãŸæ•´æ•°ã®é…åˆ—ã¯`[...Array(max - min + 1)].map((_, i) => i + min)`ã§ä½œæˆã§ãã‚‹ã®ã§ã€ã“ã‚Œã‚’`isPrime`ã§ãƒ•ã‚£ãƒ«ã‚¿ã—ã¾ã—ã‚‡ã†ã€‚

#### å•40: ã‚´ãƒ¼ãƒ«ãƒ‰ãƒãƒƒãƒã®äºˆæƒ³ã‚’ç¢ºã‹ã‚ã‚‹`goldbach`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

ã‚´ãƒ¼ãƒ«ãƒ‰ãƒãƒƒãƒã®äºˆæƒ³ã¯ã€Œå…¨ã¦ã®2ã‚ˆã‚Šã‚‚å¤§ããªå¶æ•°ã¯2ã¤ã®ç´ æ•°ã®å’Œã¨ã—ã¦è¡¨ã™ã“ã¨ãŒã§ãã‚‹ã€ã¨ã„ã†äºˆæƒ³ã§ã™ã€‚

```js
const goldbach = n => {
  if (n < 4 || n % 2 === 1) return []
  if (n === 4) return [2, 2]

  return [...Array(Math.floor(n / 2))]
    .map((_, i) => i + 1)
    .filter(e => e % 2 === 1)
    .map(e => [e, n - e])
    .find(([x, y]) => isPrime(x) && isPrime(y))
}

goldbach(28) // [5, 23]
```

`4`æœªæº€ã‚„å¥‡æ•°ãŒæ¸¡ã•ã‚ŒãŸå ´åˆã¯ç©ºé…åˆ—ã‚’è¿”ã™ã“ã¨ã«ã—ã¾ã™ã€‚  
`4`ã®å ´åˆã¯ã€`[2, 2]`ã‚’è¿”ã™ã‚ˆã†ã«ã—ã¾ã™ã€‚

å¼•æ•°ã‚’`2`ã§å‰²ã£ãŸçµæœã¾ã§ã®å¥‡æ•°ã®é…åˆ—ã‚’ä½œæˆã—ã¾ã™ã€‚  
æ¬¡ã«ã€`map`ã§ãã®å¥‡æ•°ã¨ã®å’Œã§`n`ã«ãªã‚‹ã‚ˆã†ãªæ•´æ•°ã®ãƒšã‚¢ã«å¤‰æ›ã—ã¾ã™ã€‚  
æœ€å¾Œã«ã€ä¸¡æ–¹ã¨ã‚‚ç´ æ•°ã®çµ„ã‚’`find`ã®ä¸­ã§`isPrime`ã‚’ä½¿ã£ã¦è¦‹ã¤ã‘ã¾ã™ã€‚

#### å•41: ä¸ãˆã‚‰ã‚ŒãŸç¯„å›²å†…ã®`goldbach`ã®çµæœã‚’å‡ºåŠ›ã™ã‚‹`goldbachList`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

ç¬¬ä¸‰å¼•æ•°ã‚’ä¸ãˆãŸå ´åˆã€2ã¤ã®ç´ æ•°ãŒãã®å€¤ã‚ˆã‚Šå¤§ãã„ã‚‚ã®ã®ã¿ã‚’å‡ºåŠ›ã™ã‚‹ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚

```js
const goldbachList = (min, max, gt) => {
  const result = [...Array(max - min + 1)]
    .map((_, i) => i + min)
    .filter(e => e % 2 === 0)
    .map(e => goldbach(e))

  return gt ? result.filter(([x, y]) => x > gt && y > gt) : result
}

goldbachList(9, 20) // [[3, 7], [5, 7], [3, 11], [3, 13], [5, 13], [3,17]]
goldbachList(4, 2000, 50) // [[73, 919], [61, 1321], [67, 1789], [61, 1867]]
```

å¶æ•°ã®é…åˆ—ã‚’ä½œæˆã—ã€`map`ã§`goldbach`é–¢æ•°ã‚’é©ç”¨ã™ã‚‹ã ã‘ã§ã™ã€‚  
ç¬¬ä¸‰å¼•æ•°ãŒä¸ãˆã‚‰ã‚Œã¦ã„ã‚‹å ´åˆã¯ã€ãƒšã‚¢ãŒãã®å€¤ã‚ˆã‚Šå¤§ãã„ã‹ã©ã†ã‹ã§ãƒ•ã‚£ãƒ«ã‚¿ã—ã¾ã™ã€‚


### å•46ï½50: è«–ç†ã¨ç¬¦å·

#### å•46: çœŸç†å€¤è¡¨ã‚’ä½œæˆã™ã‚‹`table`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

`table((a, b, c) => a && (b || c))`ã®ã‚ˆã†ã«ã€å¼•æ•°ãŒå¢—ãˆã¦ã‚‚çœŸç†å€¤è¡¨ã‚’å‡ºåŠ›ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚

```js
const truth = n => {
  if (n < 1) return []
  if (n === 1) return [[true], [false]]
  
  const result = []
  
  truth(n - 1).forEach(e => {
    result.push(e.concat(true))
    result.push(e.concat(false))
  })
  return result
}

const table = f => truth(f.length).map(e => [e, f(...e)])

table((a, b) => a && (a || b))
/*
[
  [[true, true], true],
  [[true, false], true],
  [[false, true], false],
  [[false, false], false]
]
*/
```

`truth`é–¢æ•°ã‚’å®šç¾©ã—ã¦ã€çœŸç†å€¤è¡¨ã§ä½¿ã†çœŸç†å€¤ã®çµ„ã¿åˆã‚ã›ã‚’ç”Ÿæˆã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚  
ã“ã‚Œã¯å†å¸°ã§è§£ã‘ã°ã€å…¨ã¦ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç°¡å˜ã«ç”Ÿæˆã§ãã¾ã™ã€‚  
`table`é–¢æ•°ã§ã¯ã€æ¸¡ã•ã‚ŒãŸé–¢æ•°ã®å¼•æ•°ã®é•·ã•ã‚’`Function.length`ã§å–å¾—ã—ã¦ã€`truth`é–¢æ•°ã«æ¸¡ã—ã¦ã„ã¾ã™ã€‚  
å¾Œã¯`map`å†…ã§æ¸¡ã•ã‚ŒãŸé–¢æ•°ã‚’å‘¼ã³å‡ºã—ã¦ãã®çµæœã‚’é…åˆ—ã«æ ¼ç´ã—ã¾ã™ã€‚

#### å•49: ä¸ãˆã‚‰ã‚ŒãŸbitæ•°ã®[ã‚°ãƒ¬ã‚¤ã‚³ãƒ¼ãƒ‰](https://ja.wikipedia.org/wiki/%E3%82%B0%E3%83%AC%E3%82%A4%E3%82%B3%E3%83%BC%E3%83%89)ã®é…åˆ—ã‚’æ±‚ã‚ã‚‹`gray`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
const gray = n => [...Array(2 ** n)].map((_, i) => Number(i ^ (i >> 1)).toString(2).padStart(n, '0'))
gray(3) // ["000","001","011","010","110","111","101","100"]
```

ã‚°ãƒ¬ã‚¤ã‚³ãƒ¼ãƒ‰ã¯ã€å¯¾è±¡ã®äºŒé€²è¡¨ç¾ã¨ã€ãã‚Œã‚’1bitå³ã‚·ãƒ•ãƒˆã—ãŸã‚‚ã®ã®`XOR`ã‚’ã¨ã‚Œã°ç”Ÿæˆã§ãã¾ã™ã€‚  
æ•°å€¤ã‚’äºŒé€²è¡¨ç¾ã®æ–‡å­—åˆ—ã¨ã—ã¦å‡ºåŠ›ã™ã‚‹ã®ã¯ã€`Number.toString`ã«åŸºæ•°ã‚’æ¸¡ã›ã°å¤‰æ›ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚  
ãã®éš›ã€é ­ã®`0`ã¯æƒã‚ãªã„ã®ã§ã€`padStart`ã‚’ç”¨ã„ã¦é•·ã•ã‚’åˆã‚ã›ã¾ã™ã€‚

#### å•50: [ãƒãƒ•ãƒãƒ³ç¬¦å·åŒ–](https://ja.wikipedia.org/wiki/%E3%83%8F%E3%83%95%E3%83%9E%E3%83%B3%E7%AC%A6%E5%8F%B7)ã‚’ã™ã‚‹`huffman`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

ç¬¦å·åŒ–ã™ã‚‹è¦ç´ ã¯`[è¨˜å·, å‡ºç¾é »åº¦]`ã§è¡¨ã•ã‚Œã¾ã™ã€‚ã¤ã„ã§ã«ã€æ–‡å­—åˆ—ã‚‚å¤‰æ›ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã—ã‚‡ã†ã€‚

```js
const huffman = raws => {
  if (typeof(raws) === 'string') {
    const characters = [...raws]
    raws = characters.filter((e, i, self) => self.indexOf(e) === i).map(e => [e, characters.filter(v => e === v).length])
  }
  if (raws.length < 2) throw new Error('ã“ã®é…åˆ—ã¯ãƒãƒ•ãƒãƒ³ç¬¦å·åŒ–ã§ãã¾ã›ã‚“')

  const sort = list => list.sort(([, a], [, b]) => a - b)

  while (raws.length >= 2) {
    raws = sort(raws)
    const [xValues, xFreq] = raws.shift()
    const [yValues, yFreq] = raws.shift()
    raws.unshift([[xValues, yValues], xFreq + yFreq])
  } 

  const result = []

  const encode = ([left, right], prefix = '') => {
    if (Array.isArray(left)) { encode(left, `${prefix}0`) } else { result.push([left, `${prefix}0`]) }
    if (Array.isArray(right)) { encode(right, `${prefix}1`) } else { result.push([right, `${prefix}1`]) }
  }
  encode(raws[0][0])

  return result.sort(([a,], [b,]) => a.codePointAt() - b.codePointAt())
}

huffman([['a', 45], ['b', 13], ['c', 12], ['d', 16], ['e', 9], ['f', 5]])
// [['a', '0'], ['b', '101'], ['c', '100'], ['d', '111'], ['e', '1101'], ['f', '1100']]
huffman('DAEBCBACBBBC') // [['A', '111'], ['B', '0'], ['C', '10'], ['D', '1100'], ['E', '1101'] ]
```

å¼•æ•°ã«æ–‡å­—åˆ—ãŒä¸ãˆã‚‰ã‚ŒãŸå ´åˆã¯ã€é‡è¤‡ã‚’æ’é™¤ã«ã—ã¦ã‹ã‚‰`map`ã§å‡ºç¾é »åº¦ã¨ãƒšã‚¢ã«ã—ã¾ã™ã€‚  
é…åˆ—ã¨ã—ã¦æ¸¡ã™ã¨ãã¨åŒã˜è¡¨ç¾ã«ãªã‚Œã°å•é¡Œã‚ã‚Šã¾ã›ã‚“ã€‚

ãƒãƒ•ãƒãƒ³ç¬¦å·åŒ–ã™ã‚‹ã«ã¯ã€ãƒãƒ•ãƒãƒ³ãƒ„ãƒªãƒ¼ã¨å‘¼ã°ã‚Œã‚‹äºŒåˆ†æœ¨ã‚’æ§‹ç¯‰ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚  
ãƒãƒ•ãƒãƒ³ãƒ„ãƒªãƒ¼ã¯æ¬¡ã®ã‚ˆã†ã«ã—ã¦ç”Ÿæˆã—ã¾ã™ï¼ˆWikipediaã‚ˆã‚Šå¼•ç”¨ï¼‰ã€‚

> 1. ã¾ãšã€è‘‰ã‚’å«ã‚€ã™ã¹ã¦ã®ç¯€ç‚¹ã®ã†ã¡ã€è¦ªã‚’æŒãŸãªã„ã‚‚ã®ã‚’é›†ã‚ã‚‹ã€‚  
> 2. ãã®ä¸­ã‹ã‚‰ã€æœ€å°ã®å€¤ã‚’æŒã¤ã‚‚ã®ã¨2ç•ªç›®ã«å°ã•ã„å€¤ã‚’æŒã¤ã‚‚ã®ã‚’å–ã‚Šå‡ºã™ã€‚
> 3. ãã‚Œã‚‰ã‚’å­ä¾›ã«æŒã¤æ–°ã—ã„ç¯€ç‚¹ã‚’ä½œã‚‹ã€‚ã“ã®ã¨ãã€æ–°ã—ã„ç¯€ç‚¹ã®å€¤ã¯ã€ä¸¡æ–¹ã®å­ä¾›ã®å€¤ã®å’Œã¨ã™ã‚‹ã€‚

ã¤ã¾ã‚Šã€ä»Šå›ã®å ´åˆã€æ¬¡ã®ã‚ˆã†ã«è¨€ã„æ›ãˆã‚‰ã‚Œã¾ã™ã€‚

1. é »åº¦ã§æ˜‡é †ã‚½ãƒ¼ãƒˆã™ã‚‹
1. å…ˆé ­ã‹ã‚‰è¦ç´ ã‚’2ã¤å–ã‚Šå‡ºã—ã€0ç•ªç›®ã®è¦ç´ ã‚’å·¦ã€1ç•ªç›®ã®è¦ç´ ã‚’å³ã¨ã™ã‚‹
1. å…ˆé ­ã«`[[å·¦, å³], é »åº¦ã®å’Œ]`ã‚’æ ¼ç´ã™ã‚‹
1. 1ï½3ã‚’é…åˆ—ã®é•·ã•ãŒ1ã«ãªã‚‹ã¾ã§ç¹°ã‚Šè¿”ã™

ã“ã‚Œã§ã€çµæœã®é…åˆ—ã®å…ˆé ­ã«ã¯ãƒãƒ•ãƒãƒ³ãƒ„ãƒªãƒ¼ãŒæ ¼ç´ã•ã‚Œã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚  

æ¬¡ã«ã€ãƒãƒ•ãƒãƒ³ãƒ„ãƒªãƒ¼ã‚’ç”¨ã„ã¦ãƒãƒ•ãƒãƒ³ç¬¦å·åŒ–ã—ã¾ã™ã€‚  
å·¦ãªã‚‰`0`ã€å³ãªã‚‰`1`ã‚’æ–‡å­—åˆ—ã®å¾Œã‚ã«ä»˜ã‘åŠ ãˆã¦ã„ãã“ã¨ã«ã—ã¾ã™ã€‚  
å­ãŒé…åˆ—ã®å ´åˆã¯ã€å†å¸°ã§å­ã®å·¦å³ã‚’è¦‹ã¦ã€è‘‰ã«çªãå½“ãŸã‚‹ã¾ã§å‡¦ç†ã‚’ç¹°ã‚Šè¿”ã—ã¾ã—ã‚‡ã†ã€‚  
å­ãŒè‘‰ã®å ´åˆã¯ã€çµæœã®é…åˆ—ã«`[å­, å­ã‚’ãƒãƒ•ãƒãƒ³ç¬¦å·åŒ–ã—ãŸã‚‚ã®]`ã‚’æ ¼ç´ã—ã¾ã™ã€‚

ãƒãƒ•ãƒãƒ³ç¬¦å·åŒ–ã®çµæœã¯å®Ÿè£…ã‚„å¼•æ•°ã«ã‚ˆã£ã¦ç•°ãªã‚Šã¾ã™ã€‚  
å¾©å·ã™ã‚‹ã«ã¯ã€ã©ã®æ–‡å­—ãŒã©ã®ç¬¦å·ã«å¯¾å¿œã—ã¦ã„ã‚‹ã‹ã®å¯¾å¿œè¡¨ï¼ˆ`huffman`é–¢æ•°ã®çµæœï¼‰ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚


### å•54ï½60: äºŒåˆ†æœ¨

#### å•54: äºŒåˆ†æœ¨ã‚¯ãƒ©ã‚¹`BinaryTree`ã‚’å®Ÿè£…ã›ã‚ˆã€‚

äºŒåˆ†æœ¨ã¯ã€ã‚ã‚‹ãƒãƒ¼ãƒ‰ãŒæŒã¤å­ã®æ•°ãŒ2å€‹ä»¥ä¸‹ã®æœ¨æ§‹é€ ã§ã™ã€‚  

ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«äºŒåˆ†æœ¨ã«ã—ãŸã„é…åˆ—ã‚’æ¸¡ã™ã¨ã€äºŒåˆ†æœ¨ã¨ã—ã¦è¡¨ç¾ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚  
å¼•æ•°ã¨ã™ã‚‹é…åˆ—ã¯ã€`[å€¤, å·¦éƒ¨åˆ†æœ¨, å³éƒ¨åˆ†æœ¨]`ã§è¡¨ç¾ã™ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚

```js
class BinaryTree {
  
  constructor(value, left = null, right = null) {
    if (Array.isArray(value)) { [value, left, right] = value } 
    else if (BinaryTree.isBinaryTree(value)) { ({value, left, right} = value) }

    this.value = value
    this.left = left !== null ? new BinaryTree(left) : left
    this.right = right !== null ? new BinaryTree(right) : right
  }

  toString() {
    return JSON.stringify(this, null, 2)
  }
}
BinaryTree.isBinaryTree = v => v !== null && typeof(v) === 'object' && v.hasOwnProperty('value') && v.hasOwnProperty('left') && v.hasOwnProperty('right')

const tree = new BinaryTree(['a', ['b', 'd', 'e'], ['c', null, ['f', 'g', null]]])
console.log(tree.toString())
/*
{
  "value": "a",
  "left": {
    "value": "b",
    "left": {
      "value": "d",
      "left": null,
      "right": null
    },
    "right": {
      "value": "e",
      "left": null,
      "right": null
    }
  },
  "right": {
    "value": "c",
    "left": null,
    "right": {
      "value": "f",
      "left": {
        "value": "g",
        "left": null,
        "right": null
      },
      "right": null
    }
  }
}
*/
```

äºŒåˆ†æœ¨ã‚’è¡¨ç¾ã—ãŸé…åˆ—ãŒæ¸¡ã•ã‚ŒãŸã‚‰ã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®å¼•æ•°ã®`value`ã€`left`ã€`right`ã«åˆ†å‰²ä»£å…¥ã—ã¾ã™ã€‚  
ã¾ãŸã€`value`ã«äºŒåˆ†æœ¨ãŒæ¸¡ã•ã‚ŒãŸã¨ãã¯ã€ãã®äºŒåˆ†æœ¨ã®ã‚³ãƒ”ãƒ¼ã‚’ä½œæˆã§ãã‚‹ã‚ˆã†ã«ã—ã¦ãŠãã¾ã™ã€‚  
JavaScriptã§ã¯ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’è¤‡æ•°å®šç¾©ã™ã‚‹ã“ã¨ãŒã§ããªã„ã®ã§ã€æ“¬ä¼¼çš„ã«å®šç¾©ã—ãŸã„å ´åˆã¯å¼•æ•°ã®æ•°ã‚„å‹ãªã©ã§æ¡ä»¶ã‚’åˆ†å²ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚  

çµæœã‚’è¦‹ãŸã„ã¨ãã€ä»Šå›ã®å ´åˆã¯`toString`ã§JSONã«ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã§ãã‚‹ã‚ˆã†ã«ã—ã¦ãŠãã¨æœ¨æ§‹é€ ãŒæŠŠæ¡ã—ã‚„ã™ããªã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼ˆã®ã§ã€å•é¡Œã«è¿½åŠ ã—ã¾ã—ãŸï¼‰ã€‚

#### å•55: å·¦éƒ¨åˆ†æœ¨ã¨å³éƒ¨åˆ†æœ¨ã®ãƒãƒ¼ãƒ‰ã®æ•°ã®å·®ãŒ1ä»¥ä¸‹ã§ã‚ã‚‹äºŒåˆ†æœ¨ã‚’å…¨ã¦ç”Ÿæˆã™ã‚‹`cbalTree`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

ä¸‹è¨˜ã®çœç•¥ã•ã‚Œã¦ã„ã‚‹`[BinaryTree]`ã®éƒ¨åˆ†ã¯ã€`BinaryTree { value: 'x', left: null, right: null }`ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚

```js
BinaryTree.cbalTree = n => {
  n = Math.floor(n)
  if (n <= 0) return [null]
  if (n === 1) return [new BinaryTree('x')]
  
  const result = []

  if (n % 2 === 1) {
    const trees = BinaryTree.cbalTree((n - 1) / 2)
    trees.forEach(left => trees.forEach(right => result.push(new BinaryTree('x', left, right))))

  } else {
    const left = BinaryTree.cbalTree(n / 2 - 1)
    const right = BinaryTree.cbalTree(n / 2)

    left.forEach(l => right.forEach(r => result.push(...[new BinaryTree('x', l, r), new BinaryTree('x', r, l)])))
  }

  return result
}

BinaryTree.cbalTree(4)
/*
[ BinaryTree {
    value: 'x',
    left: BinaryTree { value: 'x', left: null, right: null },
    right: BinaryTree { value: 'x', left: null, right: [BinaryTree] } },
  BinaryTree {
    value: 'x',
    left: BinaryTree { value: 'x', left: null, right: [BinaryTree] },
    right: BinaryTree { value: 'x', left: null, right: null } },
  BinaryTree {
    value: 'x',
    left: BinaryTree { value: 'x', left: null, right: null },
    right: BinaryTree { value: 'x', left: [BinaryTree], right: null } },
  BinaryTree {
    value: 'x',
    left: BinaryTree { value: 'x', left: [BinaryTree], right: null },
    right: BinaryTree { value: 'x', left: null, right: null } } ]
*/
```

å†å¸°ã•ã›ãŸã„ã®ã§ã€çµ‚äº†ã™ã‚‹æ¡ä»¶ã‹ã‚‰å…ˆã«è€ƒãˆã¦ã—ã¾ã„ã¾ã—ã‚‡ã†ã€‚  
`0`ä»¥ä¸‹ãªã‚‰ãã‚‚ãã‚‚æœ¨æ§‹é€ ãŒç„¡ã„ã®ã§`null`ã§ã€`1`ãªã‚‰`x`ã®ãƒãƒ¼ãƒ‰ãŒã‚ã‚‹ã ã‘ã®æœ¨ã§ã™ã€‚  
å·¦å³ã®éƒ¨åˆ†æœ¨ã®ãƒãƒ¼ãƒ‰æ•°ã®åˆè¨ˆã¯æ ¹ã‚’å–ã‚Šé™¤ã„ãŸæ•°ãªã®ã§`n - 1`ã«ãªã‚Šã¾ã™ã€‚  

`n`ãŒå¥‡æ•°ã®ã¨ãã€å·¦éƒ¨åˆ†æœ¨ã¨å³éƒ¨åˆ†æœ¨ã®ãƒãƒ¼ãƒ‰ã®æ•°ã®å·®ã¯`0`ã§ã™ã€‚  
ãªã®ã§`cbalTree((n - 1) / 2)`ã®çµæœã‚’äºŒé‡ãƒ«ãƒ¼ãƒ—ã•ã›ã¦ã€å…¨ã¦ã®äºŒåˆ†æœ¨ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

`n`ãŒå¶æ•°ã®ã¨ãã€å·¦éƒ¨åˆ†æœ¨ã¨å³éƒ¨åˆ†æœ¨ã®ãƒãƒ¼ãƒ‰ã®æ•°ã®å·®ã¯`1`ã§ã™ã€‚  
`2`ã®å ´åˆã‚’è€ƒãˆã¦ã¿ã‚‹ã¨ã€å·¦å³ã®ã©ã¡ã‚‰ã‹ãŒ`null`ã«ãªã‚‹ã“ã¨ãŒåˆ†ã‹ã‚‹ã¨æ€ã„ã¾ã™ã€‚  
ã¤ã¾ã‚Šã€å·¦å³ã®éƒ¨åˆ†æœ¨ãŒ`cbalTree(n / 2 - 1)`ã¨`cbalTree(n / 2)`ã®çµæœã‚’çµ„ã¿åˆã‚ã›ãŸãƒ‘ã‚¿ãƒ¼ãƒ³ã«ãªã‚Šã¾ã™ã€‚

#### å•56: äºŒåˆ†æœ¨ãŒå¯¾ç§°ã‹ã©ã†ã‹ã‚’è¿”ã™`isSymmetric`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

ãƒãƒ¼ãƒ‰ã®å€¤ã¯æ¯”è¼ƒã—ã¾ã›ã‚“ã€‚ã‚ãã¾ã§ã€æ§‹é€ ãŒå¯¾ç§°ã‹ã©ã†ã‹ã‚’èª¿ã¹ã¾ã™ã€‚

```js
class BinaryTree {
  /* çœç•¥ */
  get isSymmetric() {
    const mirror = (x, y) => {
      if (x === null && y === null) return true
      if (x !== null && y !== null) return mirror(x.left, y.right) && mirror(x.right, y.left)
      return false
    }
    return mirror(this, this)
  }
}

const x = new BinaryTree(['x', 'x', null])
const y = new BinaryTree(['x', 'x', 'x'])

x.isSymmetric // false
y.isSymmetric // true
```

`mirror`é–¢æ•°ã¯äºŒã¤ã®æœ¨ã‚’æ¯”è¼ƒã—ã¦å¯¾ç§°ã‹ã©ã†ã‹ã‚’èª¿ã¹ã¦ãã‚Œã‚‹é–¢æ•°ã§ã™ã€‚  
å·¦ã®è¦ç´ ã¨å³ã®è¦ç´ ãŒ`null`ã®å ´åˆã¯`true`ã«ã—ã¾ã™ã€‚  
æœ¨æ§‹é€ ãŒå…¥ã£ã¦ã„ã‚‹å ´åˆã¯ã€å·¦å³ã®è¦ç´ ã‚’`mirror`é–¢æ•°ã‚’å†å¸°å‘¼ã³å‡ºã—ã™ã‚‹ã“ã¨ã§æ¯”è¼ƒã—ã¾ã™ã€‚  

`mirror`é–¢æ•°ã®æœ€åˆã®å‘¼ã³å‡ºã—ã¯ã€ã“ã®äºŒåˆ†æœ¨è‡ªèº«(`this`)ã‚’æ¸¡ã—ã¾ã—ã‚‡ã†ã€‚

#### å•57: äºŒåˆ†æ¢ç´¢æœ¨ã‚’ç”Ÿæˆã™ã‚‹`searchTree`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

å¼•æ•°ã¯ä¸€æ¬¡å…ƒé…åˆ—ã¨ã—ã¾ã™ã€‚

```js
BinaryTree.searchTree = numbers => {
  if (numbers.length === 0) return null
  const [x, ...xs] = numbers

  const tree = new BinaryTree(x)
  let target = tree

  const insert = n => {
    const property = n < target.value ? 'left' : 'right'

    if (target[property] !== null) {
      target = target[property]
      insert(n)
    } else {
      target[property] = new BinaryTree(n)
      target = tree
    }
  }
  xs.forEach(insert)
  
  return tree
}

BinaryTree.searchTree([3, 2, 5, 7, 1])
/*
BinaryTree {
  value: 3,
  left:
   BinaryTree {
     value: 2,
     left: BinaryTree { value: 1, left: null, right: null },
     right: null },
  right:
   BinaryTree {
     value: 5,
     left: null,
     right: BinaryTree { value: 7, left: null, right: null } } }
*/
BinaryTree.searchTree([5, 3, 18, 1, 4, 12, 21]).isSymmetric // true
BinaryTree.searchTree([3, 2, 5, 7, 4]).isSymmetric // false
```

äºŒåˆ†æ¢ç´¢æœ¨ã§ã¯ã€æŒ¿å…¥ã—ã‚ˆã†ã¨ã—ã¦ã„ã‚‹å€¤ãŒç€ç›®ã—ã¦ã„ã‚‹ãƒãƒ¼ãƒ‰ã®å€¤ã‚ˆã‚Šå°ã•ã‘ã‚Œã°å·¦ã«ã€ãã‚Œä»¥ä¸Šãªã‚‰å³ã«æŒ¿å…¥ã‚’è©¦ã¿ã¾ã™ã€‚  
æŒ¿å…¥å…ˆã«ã‚‚ãƒãƒ¼ãƒ‰ãŒã‚ã‚‹ãªã‚‰åŒæ§˜ã®æ“ä½œã‚’ç¹°ã‚Šè¿”ã—ã¦ã„ãã€ä½•ã‚‚ãªã‘ã‚Œã°ï¼ˆ`null`ã®å ´åˆï¼‰æŒ¿å…¥ã—ã¾ã™ã€‚  
è§£ç­”ä¾‹ã§ã¯ã€`insert`é–¢æ•°ã‚’å†å¸°å‘¼ã³å‡ºã—ã™ã‚‹ã“ã¨ã§ã€æŒ¿å…¥ä½ç½®ã‚’æ±ºå®šã—ã¦æŒ¿å…¥ã—ã¦ã„ã¾ã™ã€‚

JavaScriptã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯é€£æƒ³é…åˆ—ã®ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã®ã§ã€æ·»å­—ã«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£åã‚’æ¸¡ã›ã°å‚ç…§ã§ãã¾ã™ã€‚  
ä»Šå›ã®ã‚ˆã†ã«å·¦ã‚„å³ã‚’è¦‹ã‚‹ã ã‘ã§ã‚ã‚Œã°ä¾¿åˆ©ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚  

#### å•58: å•55ã®ã‚ˆã†ã«å¹³è¡¡ã§ã€ã‹ã¤å¯¾ç§°ãªäºŒåˆ†æœ¨ãŒã‚ã‚Œã°è¿”ã™`symCbalTrees`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

å¼•æ•°ã¯ãƒãƒ¼ãƒ‰æ•°ã§ã€ãã®ã‚ˆã†ãªäºŒåˆ†æœ¨ãŒè¦‹ã¤ã‹ã‚‰ãªã‘ã‚Œã°`[]`ã‚’è¿”ã—ã¾ã™ã€‚  

```js
BinaryTree.symCbalTrees = n => BinaryTree.cbalTree(n).filter(e => e.isSymmetric)

BinaryTree.symCbalTrees(5)
/*
[ BinaryTree {
    value: 'x',
    left: BinaryTree { value: 'x', left: null, right: [BinaryTree] },
    right: BinaryTree { value: 'x', left: [BinaryTree], right: null } },
  BinaryTree {
    value: 'x',
    left: BinaryTree { value: 'x', left: [BinaryTree], right: null },
    right: BinaryTree { value: 'x', left: null, right: [BinaryTree] } } ]
*/
```

`cbalTree`ã®çµæœã‚’`isSymmetric`ã§ãƒ•ã‚£ãƒ«ã‚¿ã™ã‚‹ã ã‘ã§ã™ã€‚  
æ—¢ã«å˜ä½“ãƒ†ã‚¹ãƒˆæ¸ˆã¿ãªã‚‰ã€ä»Šã¾ã§ä½œã£ãŸé–¢æ•°ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã®ãŒå®‰å…¨ã§ã—ã‚‡ã†ã€‚

#### å•59: å·¦éƒ¨åˆ†æœ¨ã¨å³éƒ¨åˆ†æœ¨ã®é«˜ã•ã®å·®ãŒ1ä»¥ä¸‹ã§ã‚ã‚‹äºŒåˆ†æœ¨ã‚’å…¨ã¦ç”Ÿæˆã™ã‚‹`hbalTree`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

å¼•æ•°ã¯ç”Ÿæˆã™ã‚‹æœ¨æ§‹é€ ã®é«˜ã•ï¼ˆæ ¹ãƒãƒ¼ãƒ‰ã®é«˜ã•ï¼‰ã¨ã—ã¾ã™ã€‚

```js
BinaryTree.hbalTree = maxHeight => {
  if (maxHeight <= 0) return [null]
  if (maxHeight === 1) return [new BinaryTree('x')]

  const highers = BinaryTree.hbalTree(maxHeight - 1)
  const lowers = BinaryTree.hbalTree(maxHeight - 2)

  const result = []
  lowers.forEach(lower => highers.forEach(higher => result.push(new BinaryTree('x', lower, higher))))
  highers.forEach(x => highers.forEach(y => result.push(new BinaryTree('x', x, y))))
  highers.forEach(higher => lowers.forEach(lower => result.push(new BinaryTree('x', higher, lower))))

  return result
}

BinaryTree.hbalTree(3)[0]
/*
BinaryTree {
  value: 'x',
  left: BinaryTree { value: 'x', left: null, right: null },
  right:
   BinaryTree {
     value: 'x',
     left: null,
     right: BinaryTree { value: 'x', left: null, right: null } } }
*/
BinaryTree.hbalTree(4).length // 315
```

ã“ã®ã‚ˆã†ãªäºŒåˆ†æœ¨ã‚’[AVLæœ¨](https://ja.wikipedia.org/wiki/AVL%E6%9C%A8)ã¨ã„ã„ã¾ã™ã€‚  
AVLæœ¨ã¯ã©ã®å·¦éƒ¨åˆ†æœ¨ã¨å³éƒ¨åˆ†æœ¨ã‚’è¦‹ã¦ã‚‚é«˜ã•ã®å·®ãŒ1ä»¥ä¸‹ã§ã™ã€‚ã¤ã¾ã‚Šã€

- å·¦éƒ¨åˆ†æœ¨ãŒä½ãã¦å³éƒ¨åˆ†æœ¨ãŒé«˜ã„äºŒåˆ†æœ¨
- å·¦éƒ¨åˆ†æœ¨ã¨å³éƒ¨åˆ†æœ¨ã®é«˜ã•ãŒåŒã˜äºŒåˆ†æœ¨
- å·¦éƒ¨åˆ†æœ¨ãŒé«˜ãã¦å³éƒ¨åˆ†æœ¨ãŒä½ã„äºŒåˆ†æœ¨

ã‚’ãã‚Œãã‚Œç”Ÿæˆã—ã¦æ ¼ç´ã™ã‚Œã°ã„ã„ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

#### å•60: ä¸ãˆã‚‰ã‚ŒãŸæ•°ã®ãƒãƒ¼ãƒ‰ã‚’æŒã¤å•59ã®ã‚ˆã†ãªäºŒåˆ†æœ¨ã‚’å…¨ã¦ç”Ÿæˆã™ã‚‹`hbalTreeNodes`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

**ãƒ’ãƒ³ãƒˆ**  
ã¾ãšã€å·¦éƒ¨åˆ†æœ¨ã¨å³éƒ¨åˆ†æœ¨ã®é«˜ã•ã®å·®ãŒ1ä»¥ä¸‹ã§ã‚ã‚‹äºŒåˆ†æœ¨ã®é«˜ã•`h`ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«å¿…è¦ãªæœ€å°ãƒãƒ¼ãƒ‰æ•°ã‚’è¨ˆç®—ã™ã‚‹`minNodes`é–¢æ•°ã‚’å®šç¾©ã—ã¾ã™ã€‚  
å°‘ã—æ•°å¼ã‚’è€ƒãˆã¦ã¿ã‚Œã°ã€æœ€å°ãƒãƒ¼ãƒ‰æ•°ã¯ãƒ•ã‚£ãƒœãƒŠãƒƒãƒæ•°åˆ—ã«è¿‘ã„ã‚‚ã®ã«ãªã‚‹ã¯ãšã§ã™ã€‚  
æ¬¡ã«ã€`minNodes`é–¢æ•°ã‚’ç”¨ã„ã¦ã€å•é¡Œã®æœ¨æ§‹é€ ã®æœ€å¤§ã®é«˜ã•ã‚’æ±‚ã‚ã‚‹`maxHeight`é–¢æ•°ã‚’å®šç¾©ã—ã¾ã™ã€‚  
ãã®å¾Œã€æœ€å°ã‹ã‚‰æœ€å¤§ã¾ã§ã®é«˜ã•ã«ã¤ã„ã¦ã€ä¸ãˆã‚‰ã‚ŒãŸãƒãƒ¼ãƒ‰æ•°ã‚’æŒã¤äºŒåˆ†æœ¨ãŒã‚ã‚‹ã‹ã©ã†ã‹èª¿ã¹ã¾ã™ã€‚

```js
class BinaryTree {
  /* çœç•¥ */
  get countNodes() {
    const count = tree => tree === null ? 0 : count(tree.left) + count(tree.right) + 1
    return count(this)
  }
}

const hbalTreeMaxHeight = (n, prev = 0, ac = 1, height = 1) => {
  if (n < 1) return 0
  const value = prev + ac + 1
  return n < value ? height : hbalTreeMaxHeight(n, ac, value, height + 1)
}

BinaryTree.hbalTreeNodes = n => {
  if (n <= 0) return [null]

  const minHeight = Math.ceil(Math.log2(n + 1))
  const maxHeight = hbalTreeMaxHeight(n)
  const result = []

  for (let i = minHeight; i <= maxHeight; i++) {
    const trees = BinaryTree.hbalTree(i).filter(e => e.countNodes === n)
    result.push(...trees)
  }
  return result
}

BinaryTree.hbalTreeNodes(15).length // 1553
[0, 1, 2, 3].map(BinaryTree.hbalTreeNodes)
/*
[ [ null ],
  [ BinaryTree { value: 'x', left: null, right: null } ],
  [ BinaryTree { value: 'x', left: null, right: [BinaryTree] },
    BinaryTree { value: 'x', left: [BinaryTree], right: null } ],
  [ BinaryTree { value: 'x', left: [BinaryTree], right: [BinaryTree] } ] ]
*/
```

å…ˆã«ã€`BinaryTree`ã‚¯ãƒ©ã‚¹ã«åˆè¨ˆãƒãƒ¼ãƒ‰æ•°ã‚’è¨ˆç®—ã™ã‚‹`countNodes`ã‚’å®šç¾©ã—ã¦ãŠãã¾ã™ã€‚  

é«˜ã•`h`ã®AVLæœ¨ã®æœ€å°ãƒãƒ¼ãƒ‰æ•°ã‚’æ±‚ã‚ã‚‹é–¢æ•°`a(h)`ã«ã¤ã„ã¦è€ƒãˆã¾ã—ã‚‡ã†ã€‚  
é«˜ã•`1`ã®ã¨ãã¯æœ€å°ãƒãƒ¼ãƒ‰æ•°ã¯`1`ã§ã™ã€‚é«˜ã•`2`ã®ã¨ãã¯`2`ã§ã€é«˜ã•`3`ã®ã¨ãã¯`4`ã§ã™ã­ã€‚  
ã¾ãŸã€é«˜ã•`h`ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ãƒãƒ¼ãƒ‰æ•°ã‚’æœ€å°ã«ã™ã‚‹å ´åˆã€å·¦éƒ¨åˆ†æœ¨ã¨å³éƒ¨åˆ†æœ¨ã®é«˜ã•ãŒç•°ãªã‚Šã¾ã™ã€‚  
ã¤ã¾ã‚Šã€ä¸€æ–¹ã®éƒ¨åˆ†æœ¨ã®æœ€å°ãƒãƒ¼ãƒ‰æ•°ã¯`a(h - 1)`ã§ã€ã‚‚ã†ä¸€æ–¹ã®éƒ¨åˆ†æœ¨ã®æœ€å°ãƒãƒ¼ãƒ‰æ•°ã¯`a(h - 2)`ã¨ãªã‚Šã¾ã™ã€‚  
æ ¹ã‚‚å«ã‚ã‚‹ã®ã§ã€`a(h) = a(h - 1) + a(h - 2) + 1`ã¨ãªã‚Šã¾ã™ã€‚
ï¼ˆ`n`ç•ªç›®ã®ãƒ•ã‚£ãƒœãƒŠãƒƒãƒæ•°ã¯`a(n) = a(n - 1) + a(n - 2)`ãªã®ã§ã€ã“ã®æ¼¸åŒ–å¼ã«ã‹ãªã‚Šä¼¼ã¦ã„ã¾ã™ã­ï¼‰

æ±‚ã‚ãŸ`a(h)`ã«ã‚ˆã‚Šã€é«˜ã•`h`ã®AVLæœ¨ã®æœ€å°ãƒãƒ¼ãƒ‰æ•°ã¯`[1, 2, 4, 7, 12, 20, 33, 54, 88, 143, ...]`ã®ã‚ˆã†ã«ãªã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã—ãŸã€‚  
ã“ã®é…åˆ—ã®`index + 1`ãŒæœ€å¤§ã®é«˜ã•ã¨ä¸€è‡´ã—ã¦ã„ã‚‹ãŸã‚ã€ãƒãƒ¼ãƒ‰æ•°ã¨æ•°åˆ—ã‚’æ¯”è¼ƒã—ãªãŒã‚‰æœ€å¤§ã®é«˜ã•ã‚’æ±‚ã‚ã‚‹`hbalTreeMaxHeight`é–¢æ•°ã‚’å®šç¾©ã—ã¾ã™ã€‚  
ã¾ãŸã€æœ€å°ã®é«˜ã•ã¯ãƒãƒ¼ãƒ‰ã‚’é †ã«è©°ã‚ã¦ã„ããŸã‚ã€`Math.ceil(Math.log2(n + 1))`ã«ãªã‚Šã¾ã™ã€‚

ã‚ã¨ã¯æœ€å°ã‹ã‚‰æœ€å¤§ã®é«˜ã•ã¾ã§`hbalTree`ã§AVLæœ¨ã‚’å…¨ã¦ç”Ÿæˆã—ã¦`countNodes`ã§ãƒ•ã‚£ãƒ«ã‚¿ã—ã¾ã™ã€‚


### å•61ï½69: äºŒåˆ†æœ¨ã€ç¶šã

#### å•61: äºŒåˆ†æœ¨ã®è‘‰ã®æ•°ã‚’æ•°ãˆã‚‹`countLeaves`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
class BinaryTree {
  /* çœç•¥ */
  get countLeaves() {
    const count = tree => {
      if (tree === null) return 0
      const { left, right } = tree
      return left === null && right === null ? 1 : count(left) + count(right)
    }
    return count(this)
  }
}

(new BinaryTree([1, [2, null, 4], 2])).countLeaves // 2
```

è‘‰ä»¥å¤–ã®ãƒãƒ¼ãƒ‰ã¯ç„¡è¦–ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã€`count`é–¢æ•°ã‚’å†å¸°ã•ã›ã¦æ•°ãˆã¾ã™ã€‚

#### å•61A: äºŒåˆ†æœ¨ã®è‘‰ã®ãƒªã‚¹ãƒˆã‚’è¿”ã™`leaves`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
class BinaryTree {
  /* çœç•¥ */
  get leaves() {
    const take = tree => {
      if (tree === null) return []
      const { value, left, right } = tree
      return left === null && right === null ? [value] : [...take(left), ...take(right)]
    }
    return take(this)
  }
}

(new BinaryTree([1, [2, null, 4], 2])).leaves // [ 4, 2 ]
```

`countLeaves`ã®çµæœã‚’å°‘ã—å¤‰ãˆã‚Œã°å®Ÿè£…ã§ãã¾ã™ã€‚  
è‘‰ãªã‚‰`value`ã®ã¿æ ¼ç´ã•ã‚ŒãŸé…åˆ—ã‚’è¿”ã—ã€ãã‚Œä»¥å¤–ãªã‚‰å†å¸°ã—ã¾ã™ã€‚

#### å•62: äºŒåˆ†æœ¨ã®å†…éƒ¨ãƒãƒ¼ãƒ‰ï¼ˆè‘‰ä»¥å¤–ã®ç¯€ï¼‰ã‚’è¿”ã™`internals`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
class BinaryTree {
  /* çœç•¥ */
  get internals() {
    const take = tree => {
      if (tree === null) return []
      const { value, left, right } = tree
      return left === null && right === null ? [] : [value, ...take(left), ...take(right)]
    }
    return take(this)
  }
}

(new BinaryTree([1, [2, null, 4], 2])).internals // [ 1, 2 ]
```

ã“ã‚Œã‚‚`leaves`ã‚’å°‘ã—å¤‰ãˆã‚Œã°å®Ÿè£…ã§ãã¾ã™ã€‚  
è‘‰ãªã‚‰ç©ºé…åˆ—ã‚’è¿”ã™ã‚ˆã†ã«ã—ã¦ã€ãã‚Œä»¥å¤–ãªã‚‰`value`ï¼ˆå†…éƒ¨ãƒãƒ¼ãƒ‰ï¼‰ã¨ã€`left`ã¨`right`ã®å†…éƒ¨ãƒãƒ¼ãƒ‰ã®é…åˆ—ã‚’çµåˆã—ãŸã‚‚ã®ã‚’è¿”ã—ã¾ã™ã€‚

#### å•62B: æŒ‡å®šã•ã‚ŒãŸæ·±ã•ã®ãƒãƒ¼ãƒ‰ã®ãƒªã‚¹ãƒˆã‚’è¿”ã™`atLevel`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

```js
class BinaryTree {
  /* çœç•¥ */
  atLevel(level) {
    if (level === 1) return [this.value]

    if (level > 1) {
      const left = this.left === null ? [] : this.left.atLevel(level - 1)
      const right = this.right === null ? [] : this.right.atLevel(level - 1)
      return [...left, ...right]
    }
    return []
  }
}

(new BinaryTree([1, [2, null, 4], 2])).atLevel(2) // [ 2, 2 ]
```

`level`ãŒ`1`ãªã‚‰ã€ãã®æ·±ã•ã®ãƒãƒ¼ãƒ‰ã®å€¤ã®ã¿ã‚’è¿”ã—ã¾ã™ã€‚  
`level`ãŒ`1`ã‚ˆã‚Šå¤§ãã„å ´åˆã€å·¦å³ã®éƒ¨åˆ†æœ¨ãŒ`null`ã§ãªã„ãªã‚‰ã€ãã‚Œãã‚Œ`atLevel(level - 1)`ã‚’å‘¼ã³ã¾ã™ã€‚  
å¾—ã‚‰ã‚ŒãŸé…åˆ—ã‚’çµåˆã™ã‚‹ã¨ã€çµæœçš„ã«åŒã˜æ·±ã•ã®ãƒãƒ¼ãƒ‰ã‚’é›†ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

#### å•63: å®Œå…¨äºŒåˆ†æœ¨ã‚’ç”Ÿæˆã™ã‚‹`completeBinaryTree`é–¢æ•°ã¨ã€å®Œå…¨äºŒåˆ†æœ¨ã‹ã©ã†ã‹ã‚’è¿”ã™`isCompleteBinaryTree`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

å®Œå…¨äºŒåˆ†æœ¨ã¯ã€æ ¹ã‹ã‚‰ã™ã¹ã¦ã®è‘‰ã¾ã§ã®æ·±ã•ã®å·®ãŒ1ä»¥ä¸‹ã§ã€è‘‰ãŒå·¦è©°ã‚ã«ãªã£ã¦ã„ã‚‹äºŒåˆ†æœ¨ã§ã™ã€‚  
å¼•æ•°ã¯ãƒãƒ¼ãƒ‰æ•°ã¨ã—ã¾ã™ã€‚

```js
class BinaryTree {
  /* çœç•¥ */
  get isCompleteBinaryTree() {
    const equals = (x, y) => {
      if (x === null && y === null) return true
      if (x !== null && y !== null) return equals(x.left, y.left) && equals(x.right, y.right)
      return false
    }
    return equals(this, BinaryTree.completeBinaryTree(this.countNodes))
  }
}
BinaryTree.completeBinaryTree = n => ((f = x => x > n ? null : new BinaryTree('x', f(x * 2), f(x * 2 + 1))) => f(1))()

BinaryTree.completeBinaryTree(4)
/*
BinaryTree {
  value: 'x',
  left:
   BinaryTree {
     value: 'x',
     left: BinaryTree { value: 'x', left: null, right: null },
     right: null },
  right: BinaryTree { value: 'x', left: null, right: null } }
*/
(new BinaryTree(['x', ['x', 'x', null], ['x', null, null]])).isCompleteBinaryTree // true
(new BinaryTree(['x', ['x', 'x', null], ['x', null, 'x']])).isCompleteBinaryTree // false
```

å®Œå…¨äºŒåˆ†æœ¨ã®å¹…å„ªå…ˆæ¢ç´¢ã«ã¤ã„ã¦ã€ä»»æ„ã®éƒ¨åˆ†æœ¨ã®æ ¹ãƒãƒ¼ãƒ‰ã‚’`n`ç•ªç›®ã¨ã™ã‚‹ã¨ãã€å­ãƒãƒ¼ãƒ‰ã¯å·¦ãŒ`2n`ç•ªç›®ã€å³ãŒ`2n + 1`ç•ªç›®ã«ãªã‚Šã¾ã™ã€‚  
ã“ã‚Œã‚’åˆ©ç”¨ã™ã‚‹ã¨`completeBinaryTree`é–¢æ•°ã‚’å®šç¾©ã§ãã¾ã™ã€‚æŒ‡å®šã—ãŸãƒãƒ¼ãƒ‰æ•°ã‚’è¶…ãˆã¦ã—ã¾ã£ãŸå ´åˆã¯`null`ã‚’è¿”ã—ã¾ã™ã€‚

äºŒåˆ†æœ¨ãŒå®Œå…¨äºŒåˆ†æœ¨ã‹ã©ã†ã‹ã‚’èª¿ã¹ã‚‹ã«ã¯ã€èª¿ã¹ãŸã„äºŒåˆ†æœ¨ã®ãƒãƒ¼ãƒ‰æ•°ã‹ã‚‰å®Œå…¨äºŒåˆ†æœ¨ã‚’ç”Ÿæˆã—ã¦ã€ã“ã‚Œã‚‰ã®æ§‹é€ ãŒç­‰ã—ã„ã‹ã©ã†ã‹ã‚’ç¢ºã‹ã‚ã¾ã—ã‚‡ã†ã€‚

#### å•64: æ¬¡ã®å›³ã®ã‚ˆã†ã«ã€å„ãƒãƒ¼ãƒ‰ã«åº§æ¨™ã‚’ä»˜ä¸ã™ã‚‹`layout`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

![å•64](./img/p64.gif)

æ¬¡ã®ã‚ˆã†ã«ãƒãƒ¼ãƒ‰ã«åº§æ¨™ã‚’å‰²ã‚ŠæŒ¯ã‚Šã¾ã™ã€‚

- xåº§æ¨™ã¯ã€ä¸­é †ã«èµ°æŸ»ã—ãŸã¨ãã®é †ç•ª
- yåº§æ¨™ã¯ã€ãã®ãƒãƒ¼ãƒ‰ãŒã‚ã‚‹æ·±ã•

çµæœãŒè¦‹ã¥ã‚‰ããªã‚‹ã®ã§ã€å„ãƒãƒ¼ãƒ‰ã®åº§æ¨™ã‚’åˆ†ã‹ã‚Šã‚„ã™ãå–å¾—ã§ãã‚‹`positions`é–¢æ•°ã‚‚ã¤ã„ã§ã«å®šç¾©ã—ã¾ã—ã‚‡ã†ã€‚

```js
class BinaryTree {
  /* çœç•¥ */
  get positions() {
    const f = tree => {
      if (tree === null) return []
      const { value, x, y } = tree
      return [{ value, x, y }, ...f(tree.left), ...f(tree.right)]
    }
    return f(this)
  }

  layout() {
    const f = (x, y, tree) => {
      if (tree === null) return x
      
      const lx = f(x, y + 1, tree.left)
      tree.x = lx
      tree.y = y

      return f(lx + 1, y + 1, tree.right)
    }

    f(1, 1, this)
    return this
  }
}

const result = (new BinaryTree(['n', ['k', ['c', 'a', ['h', ['g', 'e', null], null]], 'm'], ['u', ['p', null, ['s', 'q', null]], null]])).layout()
result.positions
/*
[ { value: 'n', x: 8, y: 1 },
  { value: 'k', x: 6, y: 2 },
  { value: 'c', x: 2, y: 3 },
  { value: 'a', x: 1, y: 4 },
  { value: 'h', x: 5, y: 4 },
  { value: 'g', x: 4, y: 5 },
  { value: 'e', x: 3, y: 6 },
  { value: 'm', x: 7, y: 3 },
  { value: 'u', x: 12, y: 2 },
  { value: 'p', x: 9, y: 3 },
  { value: 's', x: 11, y: 4 },
  { value: 'q', x: 10, y: 5 } ]
*/
```

`positions`ã¯ã€å„ãƒãƒ¼ãƒ‰ã®`value`ã¨`x`ã¨`y`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å…¥ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã¾ã¨ã‚ãŸé…åˆ—ã‚’è¿”ã™ã‚ˆã†ã«ã—ã¾ã™ã€‚  
ä¸­é †ã®èµ°æŸ»ã§ã¯ã€ä¸€åº¦å·¦å´ã®å­ã‚’å†å¸°ã§è¦‹ã¦ã‹ã‚‰ã€ä»Šè¦‹ã¦ã„ã‚‹ãƒãƒ¼ãƒ‰ã®xåº§æ¨™ã‚’æ±ºå®šã—ã¾ã™ã€‚  
ãã®å¾Œã€å³å´ã®å­ã®xåº§æ¨™ã‚’`æ±ºå®šã•ã‚ŒãŸxåº§æ¨™ + 1`ã¨ã—ã¦å†å¸°å‘¼ã³å‡ºã—ã—ã€ã“ã‚Œã‚’æˆ»ã‚Šå€¤ã¨ã—ã¾ã™ã€‚

#### å•65: æ¬¡ã®å›³ã®ã‚ˆã†ã«ã€å„ãƒãƒ¼ãƒ‰ã«åº§æ¨™ã‚’ä»˜ä¸ã™ã‚‹`wideLayout`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

![å•65](./img/p65.gif)

é…ç½®ãƒ«ãƒ¼ãƒ«ã¯å›³ã‚’è¦‹ã¦è€ƒãˆã¦ãã ã•ã„ã€‚  

**ãƒ’ãƒ³ãƒˆ**  
ã‚ã‚‹æ·±ã•ã®éš£æ¥ã™ã‚‹ãƒãƒ¼ãƒ‰ã®æ°´å¹³è·é›¢ãŒä¸€å®šãªã“ã¨ã«ç€ç›®ã—ã¾ã—ã‚‡ã†ã€‚

```js
class BinaryTree {
  /* çœç•¥ */
  get height() {
    const f = tree => tree === null ? 0 : Math.max(f(tree.left), f(tree.right)) + 1
    return f(this)
  }

  get leftHeight() {
    const f = tree => tree === null ? 0 : f(tree.left) + 1
    return f(this)
  }

  wideLayout() {
    const f = (x, y, sep, tree) => {
      if (tree === null) return

      tree.x = x
      tree.y = y
      f(x - sep, y + 1, sep / 2, tree.left)
      f(x + sep, y + 1, sep / 2, tree.right)
    }

    const h = this.height
    const lh = this.leftHeight
    const x = 2 ** (h - 1) - 2 ** (h - lh) + 1
    const sep = 2 ** (h - 2)

    f(x, 1, sep, this)
    return this
  }
}

const result = (new BinaryTree(['n', ['k', ['c', 'a', ['e', 'd', 'g']], 'm'], ['u', ['p', null, 'q'], null]])).wideLayout()
result.positions
/*
[ { value: 'n', x: 15, y: 1 },
  { value: 'k', x: 7, y: 2 },
  { value: 'c', x: 3, y: 3 },
  { value: 'a', x: 1, y: 4 },
  { value: 'e', x: 5, y: 4 },
  { value: 'd', x: 4, y: 5 },
  { value: 'g', x: 6, y: 5 },
  { value: 'm', x: 11, y: 3 },
  { value: 'u', x: 23, y: 2 },
  { value: 'p', x: 19, y: 3 },
  { value: 'q', x: 21, y: 4 } ]
*/
```

å›³ã‚’è¦‹ã‚‹ã¨ã€ä¸€ç•ªæ·±ã„ã¨ã“ã‚ã®äºŒåˆ†æœ¨ã¯ã€å·¦å³ã®å­ãƒãƒ¼ãƒ‰ã¨è¦ªãƒãƒ¼ãƒ‰é–“ã®xåº§æ¨™ã®è·é›¢ãŒ`1`ã§ã™ã€‚  
ã¾ãŸã€ãã‚Œã‚ˆã‚Šä¸€ã¤æµ…ã„ã¨ã“ã‚ã¯è·é›¢ãŒ`2`ã«ãªã£ã¦ã„ã¦ã€ã•ã‚‰ã«ä¸€ã¤æµ…ã„ã¨ã“ã‚ã¯`4`ã«ãªã£ã¦ã„ã¾ã™ã€‚  
ã¤ã¾ã‚Šã€æ·±ã•ã«ã‚ˆã£ã¦`[1, 2, 4, 8, ...]`ã®ã‚ˆã†ã«é–“éš”ãŒå¤§ãããªã‚Šã¾ã™ã€‚

å·¦å³ã«ãƒãƒ¼ãƒ‰ãŒã‚ã‚‹ã ã‘ã®äºŒåˆ†æœ¨ã®é«˜ã•ã¯`2`ãªã®ã§ã€é–“éš”ã¯`2 ** (é«˜ã• - 2)`ã§æ±‚ã‚ã‚‰ã‚Œãã†ã§ã™ã€‚  
é–“éš”ã¯ä¸€ã¤æ·±ã„ã¨ã“ã‚ã«ãªã‚‹ã¨åŠåˆ†ã«ãªã‚Šã¾ã™ã€‚  
xåº§æ¨™ã¯ã€å·¦ãŒ`ç¾åœ¨ã®xåº§æ¨™ - é–“éš”`ã€å³ãŒ`ç¾åœ¨ã®xåº§æ¨™ + é–“éš”`ã«ãªã‚‹ã®ã§ã€ã“ã‚Œã‚’å¼•æ•°ã«ã—ã¦å†å¸°ã—ã¾ã—ã‚‡ã†ã€‚

æœ€åˆã®é–¢æ•°å‘¼ã³å‡ºã—ã®å¼•æ•°ã§ã™ãŒã€æ ¹ãƒãƒ¼ãƒ‰ã®xåº§æ¨™ã¯`2 ** (é«˜ã• - 1) - 2 ** (é«˜ã• - å·¦ç«¯ã®å­ã¾ã§ã®é«˜ã•) + 1`ã§æ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚  
å¾Œè¿°ã—ã¦ã„ã¾ã™ãŒã€xåº§æ¨™ã‚’`0`ã‹ã‚‰å§‹ã‚ã¦å·¦ç«¯ã®ãƒãƒ¼ãƒ‰ã®xåº§æ¨™ã‚’è¦‹ã¦ã‹ã‚‰ã‚‚ã†ä¸€åº¦æŒ¯ã‚ŠãªãŠã™æ‰‹æ³•ã§ã‚‚ã€å„ãƒãƒ¼ãƒ‰ã®xåº§æ¨™ã‚’æ±‚ã‚ã‚‰ã‚Œã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚

#### å•66: æ¬¡ã®å›³ã®ã‚ˆã†ã«ã€å„ãƒãƒ¼ãƒ‰ã«åº§æ¨™ã‚’ä»˜ä¸ã™ã‚‹`compactLayout`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

![å•66](./img/p66.gif)

ã“ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’ç”¨ã„ã‚‹ã¨ã€å…¨ã¦ã®ãƒãƒ¼ãƒ‰ã«ãŠã„ã¦ä¸€å®šã®å¯¾ç§°æ€§ã‚’ä¿ã¡ã¤ã¤ã€ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆã«äºŒåˆ†æœ¨ã‚’è¡¨ç¾ã§ãã¾ã™ã€‚  
é…ç½®ãƒ«ãƒ¼ãƒ«ã¯å›³ã‚’è¦‹ã¦è€ƒãˆã¦ãã ã•ã„ã€‚  

**ãƒ’ãƒ³ãƒˆ**  
ãƒãƒ¼ãƒ‰ã¨å¾Œç¶™ãƒãƒ¼ãƒ‰é–“ã®æ°´å¹³è·é›¢ã«ç€ç›®ã—ã¾ã—ã‚‡ã†ã€‚

```js
class BinaryTree {
  /* çœç•¥ */
  compactLayout() {
    const margin = (left, right) => {
      if (left === null || right === null) return 1
      if (left.right === null || right.left === null) return 1
      return margin(left.right, right.left) + 1
    }

    const layout = (x, y, tree) => {
      if (tree === null) return
      tree.x = x
      tree.y = y
      
      const m = margin(tree.left, tree.right)
      layout(x - m, y + 1, tree.left)
      layout(x + m, y + 1, tree.right)
    }

    const leftX = tree => tree.positions.sort(({x: a}, {x: b}) => a - b)[0].x

    layout(0, 1, this)
    const x = Math.abs(leftX(this)) + 1
    layout(x, 1, this)

    return this
  }
}

const result = (new BinaryTree(['n', ['k', ['c', 'a', ['e', 'd', 'g']], 'm'], ['u', ['p', null, 'q'], null]])).compactLayout()
result.positions
/*
[ { value: 'n', x: 5, y: 1 },
  { value: 'k', x: 3, y: 2 },
  { value: 'c', x: 2, y: 3 },
  { value: 'a', x: 1, y: 4 },
  { value: 'e', x: 3, y: 4 },
  { value: 'd', x: 2, y: 5 },
  { value: 'g', x: 4, y: 5 },
  { value: 'm', x: 4, y: 3 },
  { value: 'u', x: 7, y: 2 },
  { value: 'p', x: 6, y: 3 },
  { value: 'q', x: 7, y: 4 } ]
*/
```

é–“éš”ã¯`1`ãŒæ¨™æº–ã§ã€å·¦ã®å­ãƒãƒ¼ãƒ‰ã®å³ã€å³ã®å­ãƒãƒ¼ãƒ‰ã®å·¦ãŒã‚ã‚‹ã¨`2`ã«ãªã‚‹ã‚ˆã†ã§ã™ã€‚  
ã¾ãŸã€å·¦å³å³ã€å³å·¦å·¦ãŒä¸¡æ–¹ã¨ã‚‚å­˜åœ¨ã™ã‚‹ã¨`3`ã«ãªã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚  
`margin`é–¢æ•°ã¯ã“ã®æ¯”è¼ƒã‚’å†å¸°å‘¼ã³å‡ºã—ã§ã™ã‚‹ã“ã¨ã§ã€é–“éš”ã‚’ç®—å‡ºã—ã¦ã„ã¾ã™ã€‚  
ã“ã®é–“éš”ã‚’å¼•ã‘ã°å·¦å´ã®xåº§æ¨™ã€è¶³ã›ã°å³å´ã®xåº§æ¨™ãŒæ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚

æ ¹ãƒãƒ¼ãƒ‰ã®xåº§æ¨™ãŒä¸æ˜ãªã®ã§ã€`0`ã¨ã—ã¦åº§æ¨™ã‚’è¨ˆç®—ã—ã¾ã™ã€‚  
ãã®å¾Œã€`å·¦ç«¯ã®ãƒãƒ¼ãƒ‰ã®xåº§æ¨™ã®çµ¶å¯¾å€¤ + 1`ã‚’åˆæœŸã®xåº§æ¨™ã¨ã—ã€å†ã³åº§æ¨™ã‚’è¨ˆç®—ã—ã¾ã™ã€‚

#### å•67: æ–‡å­—åˆ—ã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦äºŒåˆ†æœ¨ã«ã™ã‚‹`fromString`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

äºŒåˆ†æœ¨ã®æ–‡å­—åˆ—è¡¨ç¾ã¯`x(y,a(,b))`ã®ã‚ˆã†ã«ã—ã¦ä¸ãˆã‚‰ã‚Œã¾ã™ã€‚

```js
BinaryTree.stringToTree = str => {
  if (str === null) return null

  const regex = /^([^\(\,]+)\((.+)\)$/
  const groups = regex.exec(str)
  
  if (groups === null) {
    if (str.indexOf('(') !== -1 || str.indexOf(')') !== -1 || str.indexOf(',') !== -1) throw new Error('parse error')
    return new BinaryTree(str)
  }
  
  const [, id, arg] = groups
  const args = []
  let value = null
  let brace = 0

  for (let i = 0; i < arg.length; i++) {
    const current = arg[i]

    if (current === ',' && brace === 0) {
      args.push(value)
      value = null
    } else {
      value = (value || '') + current
    
      brace = current === '(' ? brace + 1 
        : current === ')' ? brace - 1 
        : brace
    }

    if (i === arg.length - 1) { args.push(value) }
  }
  if (args.length !== 2) throw new Error('parse error')

  const [left, right] = args
  return new BinaryTree(id, BinaryTree.stringToTree(left), BinaryTree.stringToTree(right))
}

BinaryTree.stringToTree('x(y,a(,b))')
/*
BinaryTree {
  value: 'x',
  left: BinaryTree { value: 'y', left: null, right: null },
  right:
    BinaryTree {
      value: 'a',
      left: null,
      right: BinaryTree { value: 'b', left: null, right: null } } }
*/
```

æ­£è¦è¡¨ç¾`^([^\(\,]+)\((.+)\)$`ã§ãƒãƒ¼ãƒ‰ã®å€¤ã¨æ‹¬å¼§ã®ä¸­ã®æ–‡å­—åˆ—ã‚’æŠœãå‡ºã—ã¾ã™ã€‚  
ä¸€è‡´ã—ãªã‹ã£ãŸå ´åˆã¯ãƒãƒ¼ãƒ‰ã®å€¤ã ã‘ãªã®ã§ã€æ‹¬å¼§ã‚„ã‚«ãƒ³ãƒãŒå«ã¾ã‚Œã¦ã„ãªã„ã‹ç¢ºèªã—ã¦ã‹ã‚‰äºŒåˆ†æœ¨ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã—ã¦è¿”ã—ã¾ã™ã€‚  

ä¸€è‡´ã—ãŸå ´åˆã€æ‹¬å¼§ã®ä¸­ã®æ–‡å­—åˆ—ã‚’èª¿ã¹ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚  
æ‹¬å¼§ã«å›²ã‚ã‚Œã¦ã„ãªã„ã‚«ãƒ³ãƒã§å·¦å³ã‚’åŒºåˆ‡ã‚ŠãŸã„ã®ã§ã€å¤‰æ•°`brace`ã§æ‹¬å¼§ã§å›²ã‚ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤åˆ¥ã—ã¾ã™ã€‚  
æ–‡å­—åˆ—ã‚’äºŒã¤ã«åˆ†ã‘ã‚‰ã‚ŒãŸã‚‰`stringToTree`é–¢æ•°ã‚’å†å¸°ã—ã¦å·¦éƒ¨åˆ†æœ¨ã¨å³éƒ¨åˆ†æœ¨ã‚‚æ§‹ç¯‰ã—ã¾ã™ã€‚

#### å•68: äºŒåˆ†æœ¨ã‚’å‰é †ã«èµ°æŸ»ã™ã‚‹`preorder`é–¢æ•°ã¨ã€ä¸­é †ã«èµ°æŸ»ã™ã‚‹`inorder`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚ã¾ãŸã€å‰é †ã¨ä¸­é †ã«èµ°æŸ»ã—ãŸçµæœã‚’ç”¨ã„ã¦äºŒåˆ†æœ¨ã‚’ç”Ÿæˆã™ã‚‹`preInTree`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

å‰é †ã¨ä¸­é †ã§èµ°æŸ»ã—ãŸçµæœãŒã‚ã‚Œã°ã€äºŒåˆ†æœ¨ã®æœ¨æ§‹é€ ã¯ä¸€é€šã‚Šã«å®šã‚ã‚‰ã‚Œã¾ã™ã€‚

```js
class BinaryTree {
  /* çœç•¥ */
  get preorder() {
    const f = tree => tree === null ? [] : [tree.value, ...f(tree.left), ...f(tree.right)]
    return f(this)
  }

  get inorder() {
    const f = tree => tree === null ? [] : [...f(tree.left), tree.value, ...f(tree.right)]
    return f(this)
  }
}

BinaryTree.preInTree = (preorder, inorder) => {
  if (preorder.length === 0 || inorder.length === 0) return null
  if (inorder.length === 1) return new BinaryTree(inorder[0])

  const [x, ...xs] = preorder
  const index = inorder.indexOf(x)
  if (index === -1) return BinaryTree.preInTree(xs, inorder)

  const left = inorder.slice(0, index)
  const right = inorder.slice(index + 1, inorder.length)

  return new BinaryTree(x, BinaryTree.preInTree(xs, left), BinaryTree.preInTree(xs, right))
}

const tree = BinaryTree.stringToTree('a(b(d,e),c(,f(g,)))')
tree.preorder // [ 'a', 'b', 'd', 'e', 'c', 'f', 'g' ]
tree.inorder  // [ 'd', 'b', 'e', 'a', 'c', 'g', 'f' ]
BinaryTree.preInTree(tree.preorder, tree.inorder)
/*
BinaryTree {
  value: 'a',
  left:
    BinaryTree {
      value: 'b',
      left: BinaryTree { value: 'd', left: null, right: null },
      right: BinaryTree { value: 'e', left: null, right: null } },
  right:
    BinaryTree {
      value: 'c',
      left: null,
      right:
        BinaryTree {
          value: 'f',
          left: BinaryTree { value: 'g', left: null, right: null },
          right: null } } }
*/
```

å‰é †ã€ä¸­é †ã§èµ°æŸ»ã‚’ã™ã‚‹ã¨ãã¯ã€ãã®åã®é€šã‚Šå†å¸°ã™ã‚Œã°ãƒãƒ¼ãƒ‰ã‚’é †ç•ªã«é›†ã‚ã‚‰ã‚Œã¾ã™ã€‚  
`preInTree`é–¢æ•°ã§ã™ãŒã€ã¾ãš`inorder`ã®é•·ã•ãŒ`1`ãªã‚‰ãã®è¦ç´ ã§äºŒåˆ†æœ¨ã‚’ä½œã£ã¦è¿”ã—ã¾ã™ã€‚  
`preorder`ã®å…ˆé ­ã®è¦ç´ ãŒ`inorder`ã«ç„¡ã„å ´åˆã€`preorder`ã®æ®‹ã‚Šã®è¦ç´ ã‹ã‚‰æ¢ã—ã¾ã™ã€‚  
`inorder`ã«å«ã¾ã‚Œã‚‹å ´åˆã¯ã€`inorder`ã‚’å·¦éƒ¨åˆ†æœ¨ã«å«ã¾ã‚Œã‚‹è¦ç´ ã®é…åˆ—`left`ã¨å³éƒ¨åˆ†æœ¨ã«å«ã¾ã‚Œã‚‹è¦ç´ ã®é…åˆ—`right`ã«åˆ†ã‘ã¾ã™ã€‚  
ãã‚Œãã‚Œã®é…åˆ—ã‚’`preInTree`é–¢æ•°ã®`inorder`ã¨ã—ã¦æ¸¡ã—ã¦å†å¸°ã•ã›ã‚Œã°ã€ç›®çš„ã®äºŒåˆ†æœ¨ã‚’æ§‹ç¯‰ã§ãã¾ã™ã€‚

#### å•69: æ¬¡ã®ã‚ˆã†ãªæ–‡å­—åˆ—ã‚’äºŒåˆ†æœ¨ã«å¤‰æ›ã™ã‚‹`dotstrToTree`é–¢æ•°ã¨ã€é€†å¤‰æ›ã™ã‚‹`toDotstr`é–¢æ•°ã‚’å®Ÿè£…ã›ã‚ˆã€‚

äºŒåˆ†æœ¨ã¯`'abd..e..c.fg...'`ã®ã‚ˆã†ãªæ–‡å­—åˆ—ã§è¡¨ç¾ã•ã‚Œã¦æ¸¡ã•ã‚Œã¾ã™ã€‚`.`ã¯`null`ã¨ã—ã€å„ãƒãƒ¼ãƒ‰ã«ã¯1æ–‡å­—ã—ã‹å…¥ã‚Šã¾ã›ã‚“ã€‚  
ã“ã‚Œã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦ã€æ¬¡ã®ã‚ˆã†ãªçµæœã«ãªã‚‹ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚

```js
class BinaryTree {
  /* çœç•¥ */
  toDotstr() {
    const f = tree => tree === null ? '.' : tree.value + f(tree.left) + f(tree.right)
    return f(this)
  }
}

BinaryTree.dotstrToTree = ds => {
  const f = str => {
    if (str.length === 0) return [null, '']

    let [x, ...xs] = [...str]
    xs = xs.join('')

    if (x === '.') return [null, xs]
    
    const [left, ys] = f(xs)
    const [right, rest] = f(ys)
    return [new BinaryTree(x, left, right), rest]
  }
  return f(ds)[0]
}

const tree = BinaryTree.dotstrToTree('abd..e..c.fg...') // å•68ã®äºŒåˆ†æœ¨ã¨åŒã˜
tree.toDotstr() // abd..e..c.fg...
```

æˆ»ã‚Šå€¤ã¯`[äºŒåˆ†æœ¨, æ®‹ã‚Šã®æ–‡å­—åˆ—]`ã¨ã—ã¾ã™ã€‚  

`dotstrToTree`é–¢æ•°ã§ã¯ã€æ¸¡ã—ãŸæ–‡å­—åˆ—ã‚’å…ˆé ­ã‹ã‚‰é †ç•ªã«è¦‹ã¦ã„ãã¾ã™ã€‚  
è¦‹ã¦ã„ã‚‹æ–‡å­—ãŒ`.`ãªã‚‰ã€`[null, æ®‹ã‚Šã®æ–‡å­—åˆ—]`ã‚’è¿”ã—ã¾ã™ã€‚  
ãã‚Œä»¥å¤–ã®ã¨ãã¯ã€ã¾ãšå·¦éƒ¨åˆ†æœ¨ã‚’æ§‹ç¯‰ã—ã¤ã¤æ®‹ã‚Šã®æ–‡å­—åˆ—ã‚’å–å¾—ã—ã€å³éƒ¨åˆ†æœ¨ã‚’ãã®æ®‹ã‚Šã®æ–‡å­—åˆ—ã‹ã‚‰æ§‹ç¯‰ã—ã¾ã™ã€‚  
ãã—ã¦ã€ä»Šè¦‹ã¦ã„ã‚‹æ–‡å­—ã‚’æ ¹ã¨ã—ãŸäºŒåˆ†æœ¨ã¨æ®‹ã‚Šã®æ–‡å­—åˆ—ã®ãƒšã‚¢ã‚’è¿”ã—ã¾ã™ã€‚

`toDotstr`é–¢æ•°ã¯å‰é †ã§èµ°æŸ»ã™ã‚‹ã ã‘ã§ã™ã€‚  
ãƒãƒ¼ãƒ‰ã®å€¤ãŒä¸€æ–‡å­—ã§ãªã„å ´åˆã¯æ­£ã—ãå¤‰æ›ã•ã‚Œãªã„ãŸã‚ã€ã“ã®æ–‡å­—åˆ—è¡¨ç¾ã¯ä¸€æ–‡å­—ã®å ´åˆã«ã—ã‹ä½¿ãˆã¾ã›ã‚“ã€‚

## GitHub

å„å•é¡Œã®ãƒ†ã‚¹ãƒˆã‚‚å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚  
ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦ãƒãƒ³ãƒ‰ãƒ«ã™ã‚‹è¨­å®šã«ãªã£ã¦ã„ã‚‹ãŸã‚ã€è‡ªåˆ†ç”¨ã®JSãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä½œã‚Šæ–¹ãŒåˆ†ã‹ã‚‰ãªã„ã¨ãã¯å‚è€ƒã«ãªã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
